library(shiny)
library(shinythemes)
ui<-fluidPage(
  theme=shinythemes::shinytheme ("cerulean"),
  titlePanel("Cost-effectiveness of Infant HIV Testing Strategies"),
  sidebarLayout(
  sidebarPanel(
    helpText("Default values for the selected country are displayed. Use the sliders to change this information to local settings."),
    # Dropdown menu to select country 
    selectInput("country", label = h5("Select a Country", style = "color:steelblue"), 
                choices = list("Cote d'Ivoire", "South Africa", "Zimbabwe"), 
                selected = "South Africa"),
  # Indicating Epi Parameters
  helpText(strong("Epidemiological inputs")),
  #input Maternal HIV prevalence
  sliderInput(inputId="var1", label="Maternal HIV prevalence:",value=0.308,min=0,max=0.4),
  #input Maternal HIV incidence during breastfeeding
  sliderInput(inputId="var2", label="Maternal HIV incidence during breastfeeding:",value=0.0029, min=0,max=0.1),
  # Indicating Clinical Parameters
  helpText(strong("Clinical inputs")),
  #input HIV status known in pregnancy
  sliderInput(inputId="var3", label="HIV status known in pregnancy:",value=0.89,min=0,max=1),
  #ART coverage during pregnancy/breastfeeding
  sliderInput(inputId="var4", label="ART coverage during pregnancy/breastfeeding:",value=0.95,min=0,max=1),
  #input Proportion of infants who are breastfed
  sliderInput(inputId="var5", label="Proportion of infants who are breastfed:",value=0.80,min=0,max=1),
  #input Breastfeeding duration (in months)
  sliderInput(inputId="var6", label="Breastfeeding duration (in months):",value=12,min=0,max=18),
  # Indicating program Parameters
  helpText(strong("Programmatic inputs")),
  #input Immunization coverage
  sliderInput(inputId="var7", label="Immunization coverage:",value=0.74,min=0,max=1),
  #input EID coverage
  sliderInput(inputId="var8", label="EID coverage:",value=0.95,min=0,max=1),
  #input Result-return and linkage to care/ART after PCR for EID
  sliderInput(inputId="var10", label="Result-return and linkage to care/ART after PCR for EID:",value=0.71,min=0,max=1),
  #input Result-return time for PCR in EID (in months)
  sliderInput(inputId="var11", label="Result-return time for PCR in EID (in months):",value=1,min=0,max=3),
  #input Result-return and transfer to PCR after RDT
  sliderInput(inputId="var13", label="Result-return and transfer to PCR after RDT:",value=0.8,min=0,max=1),
  #input Result-return and linkage to care/ART after PCR following RDT
  sliderInput(inputId="var16", label="Result-return and linkage to care/ART after PCR following RDT:",value=0.71,min=0,max=1),
  #input Result-return time for PCR following RDT (in months)
  sliderInput(inputId="var17", label="Result-return time for PCR following RDT (in months):",value=1,min=0,max=3),
  #input Maternal linkage to care/ART following RDT
  sliderInput(inputId="var25", label="Maternal linkage to care/ART following RDT:",value=0.804,min=0,max=1),
  # Indicating Cost Parameters
  helpText(strong("Cost inputs")),
  #input ART cost
  sliderInput(inputId="var18", label="Monthly 1st line pediatric ART cost (USD):",value=10,min=2.4,max=47.7),
  #input Cost of screening program
  sliderInput(inputId="var19", label="Cost of screening program (per mother-infant pair; USD):",value=10,min=1,max=50),
  #input Routine care cost
  sliderInput(inputId="var20", label="Monthly routine care cost (USD):",value=30,min=5,max=103),
  #input Acute OI cost
  sliderInput(inputId="var21", label="Acute OI cost (per event; USD):",value=500,min=64,max=1270),
  # Indicating Cost Parameters
  helpText(strong("Cost-effectiveness threshold")),
  #input Willingness-to-pay for health
  sliderInput(inputId="var22", label="WTP for a year of life saved (USD):",value=547,min=0,max=8000)),
  # Output
  mainPanel(
    tabsetPanel(type = "tabs",
                tabPanel(strong("About this tool"), 
                         br(),
                         p("This web tool is designed to estimate the health benefits and cost-effectiveness of screening mothers at immunization visits (as part of the Expanded Program on Immunization [EPI]) to determine infant exposure, followed by diagnostic testing of exposed infants compared to the currently WHO-recommended EID strategy (testing only known HIV-exposed infants). For this analysis, we simulated a “birth cohort” of all infants born in a given year, consisting of HIV-unexposed infants, HIV-exposed uninfected infants, and HIV-infected infants.", style = "color:grey"),
                         br(),
                         h5(strong("Competing strategies")),
                         p("The infant HIV testing strategies that are evaluated include:", style = "color:grey"),
                         p("(1) current infant testing programs, using nucleic acid testing (NAT) at 6 weeks of age for all infants born to mothers known to be living with HIV (“EID”);", style = "color:grey"),
                         p("(2) a novel program of screening all infants for HIV exposure at immunization visits (as part of the Expanded Program on Immunization [EPI]) at 6 or 10 weeks of age (by testing mothers with an antibody-based rapid diagnostic test [RDT] that detects maternal infection), followed by NAT for infants identified as HIV-exposed, in addition to current EID programs (“EID and EPI”).", style = "color:grey"),
                         br(),
                         h5(strong("Cost-effectiveness")),
                         p("Based on the information that the user provides, this tool chooses an economically optimal strategy by indicating the strategy with the greatest net health benefit (NHB). The NHB expresses the cost-effectiveness of the programs by subtracting forgone health benefits due to the resources required by the program from the gain in health from the program and is calculated by:", style = "color:grey"),
                         p("NHB = effect of program - (cost of program/WTP for health), assuming a willingness-to-pay (WTP) for health of $547 per year of life saved.", style = "color:grey"),
                         p("In some cases, the tool will suggest that the economic value of both strategies is similar, indicating that decisions can be made based on other factors such as programmatic feasibility, without substantial difference in cost-effectiveness. We hope this tool will help public health planners to allocate resources between testing strategies as efficiently as possible.", style = "color:grey"),
                         br()),
                tabPanel(strong("Parameter descriptions"),
                         br(),
                         wellPanel(h5(strong("Maternal HIV prevalence:")), 
                                   p("Maternal prevalence of HIV in antenatal care (ANC) settings.", style = "color:grey"),
                                   br(),
                                   h5(strong("Maternal HIV incidence during breastfeeding:")),
                                   p("Yearly probability of incident HIV infection among HIV-uninfected breastfeeding women.", style = "color:grey"),
                                   br(),
                                   h5(strong("HIV status known in pregnancy:")),
                                   p("Probability that maternal HIV status is known during pregnancy (e.g., HIV testing).", style = "color:grey"),
                                   br(),
                                   h5(strong("ART coverage during pregnancy/breastfeeding:")),
                                   p("Proportion of identified HIV-infected women receiving ART during pregnancy and breastfeeding (e.g., PMTCT coverage).", style = "color:grey"),
                                   br(),
                                   h5(strong("Proportion of infants who are breastfed:")),
                                   p("Proportion of infants in the birth cohort who breastfeed for any duration.", style = "color:grey"),
                                   br(),
                                   h5(strong("Breastfeeding duration, mean (in months):")),
                                   p("Among breastfed infants, mean duration of breastfeeding.", style = "color:grey"),
                                   br(),
                                   h5(strong("Immunization coverage:")),
                                   p("Proportion of all infants who present to immunization clinics at 6 weeks and undergo HIV screening.", style = "color:grey"),
                                   br(),
                                   h5(strong("EID coverage:")),
                                   p("Proportion of known HIV-exposed infants who undergo NAT for EID at 6-10 weeks.", style = "color:grey"),
                                   br(),
                                   h5(strong("Result-return and linkage to infant care/ART after NAT for EID:")),
                                   p("Following NAT for EID, probability of receiving PCR results and linking to HIV care.", style = "color:grey"),
                                   br(),
                                   h5(strong("Result-return time for NAT in EID, mean (in months):")),
                                   p("For infants receiving NAT results during EID testing, mean time to result return.", style = "color:grey"),
                                   br(),
                                   h5(strong("Result-return and transfer to infant NAT after RDT:")),
                                   p("Following rapid antibody screen, probability of receiving result and linking to recommended follow-up NAT.", style = "color:grey"),
                                   br(),
                                   h5(strong("Result-return and linkage to infant care/ART after NAT following RDT:")),
                                   p("Proportion of infants (identified as HIV-exposed from maternal screening and undergoing follow-up NAT) who receive the result of the NAT.", style = "color:grey"),
                                   br(),
                                   h5(strong("Result-return time for NAT following RDT, mean (in months):")),
                                   p("For infants receiving a NAT test after positive maternal RDT screen, mean time to NAT result return.", style = "color:grey"),
                                   br(),
                                   h5(strong("Maternal linkage to care/ART following RDT:")),
                                   p("For women newly identified with HIV through maternal screening, probability of linking to adult HIV care and ART (reducing later risk of postnatal HIV transmission to uninfected infants).", style = "color:grey"),
                                   br(),
                                   h5(strong("Monthly 1st line pediatric ART cost (USD):")),
                                   p("Monthly mean cost of 1st line pediatric ART (take the mean as these costs vary by age).", style = "color:grey"),
                                   br(),
                                   h5(strong("Cost of screening program (per mother-infant pair; USD):")),
                                   p("Cost of RDT screening program to detect maternal HIV (including rapid diagnostic test cost, personnel cost, and implementation costs), per mother-infant pair screened.", style = "color:grey"),
                                   br(),
                                   h5(strong("Monthly routine HIV care cost (USD):")),
                                   p("Routine monthly mean HIV care cost (take the mean as these costs vary by age and CD4%/CD4 count).", style = "color:grey"),
                                   br(),
                                   h5(strong("Acute OI cost (USD):")),
                                   p("Cost of care for opportunistic infections (OI), per event (take the mean as these costs vary by OI type and age).", style = "color:grey"),
                                   br(),
                                   h5(strong("WTP for a year of life saved (USD):")),
                                   p("Society's willingness-to-pay (WTP) for a year of life saved (YLS) or the maximum incremental cost-effectiveness ratio (ICER) that is consistent with an intervention being cost-effective.", style = "color:grey"))),
                tabPanel(strong("Population benefits"), 
                         br(),
                         wellPanel(
                         h5(strong("Among infants in the birth cohort, EID and EPI (as compared to EID) leads to:")),
                         textOutput("selected_var1"),
                         textOutput("selected_var2"),
                         br(),
                         h5(strong("Among infants with HIV, EID and EPI (as compared to EID) leads to:")),
                         textOutput("selected_var3"),
                         textOutput("selected_var4"),
                         textOutput("selected_var10")),
                         column(5,plotOutput("plot10", width = 400, height = 300)),
                         column(5,plotOutput("plot11", width = 400, height = 300)),
                         column(5,plotOutput("plot12", width = 400, height = 300)),
                         column(5,plotOutput("plot2", width = 400, height = 300)),
                         column(5,plotOutput("plot1", width = 400, height = 300))),
                tabPanel(strong("Economic outcomes"),
                         br(),
                         wellPanel(h5(strong("Most cost-effective strategy for birth cohort:")),
                                   textOutput("selected_var6"),
                                   br(),
                                   textOutput("selected_var25"),
                                   textOutput("selected_var26"),
                                   br(),
                                   textOutput("selected_var7")),
                         column(5,plotOutput("plot13", width = 400, height = 300)),
                         column(5,plotOutput("plot14", width = 400, height = 300))),
                                   #br(),
                                   #h5(strong("Other economic outcomes:")))),
                                   #textOutput("selected_var3"),
                tabPanel(strong("More information"),
                         br(),
                         h5(strong("CEPAC-Pediatric model", style = "#75AADB")),
                         p("The Cost-Effectiveness of Preventing AIDS Complications (CEPAC)-Pediatric model is a first-order, Monte Carlo simulation model of infant HIV infection, disease progression, diagnosis, and treatment. Technical details of the CEPAC-Pediatric model, including model flowcharts, key assumptions, sample code, and data inputs, are available in published work and at the CEPAC website [1-4; link to website: https://www.massgeneral.org/mpec/cepac/].", style = "color:grey"),
                         p("For this analysis, we simulated a “birth cohort” of all infants born in a given country in a given year, comprised of HIV-unexposed infants, HIV-exposed uninfected infants, and HIV-infected infants. A virtual cohort of 30 million infants was simulated in order to achieve stable model output. We examined two strategies: (1) current infant testing programs, using NAT-based testing at 6 weeks of age for all infants born to mothers known to be living with HIV (“EID”); and (2) a novel program of screening all infants for HIV exposure at immunization visits (as part of the Expanded Program on Immunization [EPI]) at 6 or 10 weeks of age (with an antibody-based rapid diagnostic test [RDT] that detects maternal infection), followed by NAT for infants identified as HIV-exposed, in addition to current EID programs (“EID and EPI”).", style = "color:grey"),
                         br(),
                         h5(strong("A light version of the health policy model", style = "#75AADB")),
                         p("We developed a “light” version of the CEPAC-Pediatric model - a metamodel, based on statistical analysis of model outputs from many simulation runs - to allow the user to customize the model parameters to specific settings and receive immediate results. The selection of parameters for the metamodel was based on detailed sensitivity analyses conducted for this specific policy analysis and on those routinely conducted in all CEPAC-Pediatric analyses [1-4]. We selected those parameters that had the most impact on the cost-effectiveness results for this policy question. The metamodel results were validated against the original CEPAC-Pediatric model-generated results [5]. The methodologic details of this approach have been presented [5] and submitted for publication.", style = "color:grey"),
                         br(),
                         h5(strong("Net Health Benefit", style = "#75AADB")),
                         p("The economic outcome of net health benefit (NHB) is calculated to determine the optimal infant HIV testing and screening strategy. NHB expresses the cost-effectiveness of the programs by subtracting forgone health benefits due to the resources required by the intervention from the gain in health from the intervention (NHB = effect - (cost/WTP for health)). We assumed a willingness-to-pay (WTP) for health of $547/YLS, which reflects the combined ICER of a package of services that the health sector was able to afford with the 2016-2018 HIV budget of about $1.6 billion per year in South Africa [6]. We applied an annual discount rate of 3% for both health effects and cost.", style = "color:grey"),
                         br(),
                         h5(strong("Acknowledgements", style = "#75AADB")),
                         p("This web tool was designed by Djøra Soeteman, with financial and technical support from the World Health Organization (WHO). We would like to thank the collaborating investigators and members of the WHO-CEPAC Infant Testing Steering Committee. Additional longstanding support for development of the CEPAC models in the Medical Practice Evaluation Center at Massachusetts General Hospital, Boston, MA, USA has been provided by the Eunice Kennedy Shriver National Institute of Child Health and Human Development [R01HD079214, K08 HD094638] and the National Institute of Allergy and Infectious Diseases [K01 AI078754, R37AI058736, R37AI093269, T32AI007433]. The content is solely the responsibility of the authors and does not necessarily represent the official views of the World Health Organization or the National Institutes of Health.", style = "color:grey"),
                         br(),
                         h5(strong("References", style = "#75AADB")),
                         p("[1] Francke JA, Penazzato M, Hou T, et al. Clinical impact and cost-effectiveness of diagnosing HIV infection during early infancy in South Africa: Test timing and frequency. J Infect Dis 2016;214(9):1319-28.", style = "color:grey"),
                         br(),
                         p("[2] Frank SC, Cohn J, Dunning L, et al. Clinical effect and cost-effectiveness of incorporation of point-of-care assays into early infant HIV diagnosis programmes in Zimbabwe: a modelling study. Lancet HIV. 2019 Mar;6(3):e182-e190.", style = "color:grey"),
                         br(),
                         p("[3] Dunning L, Francke JA, Mallampati D, et al. The value of confirmatory testing in early infant HIV diagnosis programmes in South Africa: A cost-effectiveness analysis. PLoS Med 2017;14(11):e1002446.", style = "color:grey"),
                         br(),
                         p("[4] Ciaranello AL, Doherty K, Penazzato M, et al. Cost-effectiveness of first-line antiretroviral therapy for HIV-infected African children less than 3 years of age. AIDS 2015;29(10):1247-59.", style = "color:grey"),
                         br(),
                         p("[5] Soeteman DI, Resch SC, Jalal H, et al. Developing and validating a metamodel of a microsimulation model of infant HIV testing and screening strategies. 17th Biennial European Meeting of the Society for Medical Decision Making; Leiden, The Netherlands, June 10, 2018.", style = "color:grey"),
                         br(),
                         p("[6] Meyer-Rath G, van Rensburg C, Larson B, Jamieson L, Rosen S. Revealed willingness-to-pay versus standard cost-effectiveness thresholds: Evidence from the South African HIV Investment Case. PLoS One. 2017;12(10):e0186496.", style = "color:grey"),
                         br()))
)))
#Define the server code
  server<-function(input,output,session){
    observe({
      if(input$country=="Cote d'Ivoire")
      updateSliderInput(session,"var1",value=0.048, min=0, max=0.4)  
  })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var1",value=0.308, min=0, max=0.4)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var1",value=0.161, min=0, max=0.4)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var2",value=0.0004, min=0,max=0.1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var2",value=0.0029, min=0,max=0.1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var2",value=0.0015, min=0,max=0.1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var3",value=0.86,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var3",value=0.89,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var3",value=0.84,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var4",value=0.70,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var4",value=0.95,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var4",value=0.95,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var5",value=0.80,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var5",value=0.80,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var5",value=0.80,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var6",value=12,min=0,max=18)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var6",value=12,min=0,max=18)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var6",value=18,min=0,max=18)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var7",value=0.99,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var7",value=0.74,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var7",value=0.94,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var8",value=0.40,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var8",value=0.95,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var8",value=0.65,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var10",value=0.71,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var10",value=0.71,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var10",value=0.71,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var11",value=1,min=0,max=3)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var11",value=1,min=0,max=3)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var11",value=1,min=0,max=3)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var13",value=0.80,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var13",value=0.80,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var13",value=0.80,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var16",value=0.71,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var16",value=0.71,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var16",value=0.71,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var17",value=1,min=0,max=3)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var17",value=1,min=0,max=3)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var17",value=1,min=0,max=3)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var25",value=0.804,min=0,max=1)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var25",value=0.804,min=0,max=1)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var25",value=0.804,min=0,max=1)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var18",value=10,min=2.4,max=47.7)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var18",value=10,min=2.4,max=47.7)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var18",value=10,min=2.4,max=47.7)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var19",value=10,min=1,max=50)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var19",value=10,min=1,max=50)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var19",value=10,min=1,max=50)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var20",value=30,min=5,max=103)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var20",value=30,min=5,max=103)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var20",value=30,min=5,max=103)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var21",value=500,min=64,max=1270)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var21",value=500,min=64,max=1270)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var21",value=500,min=64,max=1270)  
    })
    observe({
      if(input$country=="Cote d'Ivoire")
        updateSliderInput(session,"var22",value=547,min=0,max=8000)  
    })
    observe({
      if(input$country=="South Africa")
        updateSliderInput(session,"var22",value=547,min=0,max=8000)  
    })
    observe({
      if(input$country=="Zimbabwe")
        updateSliderInput(session,"var22",value=900,min=0,max=8000)  
    })
  output$selected_var0<-renderText({
  x1<-(324.567281+(-54.194813*input$var1)+(-27.350015*input$var2)+(-3.831436*input$var3)+(0.268691*input$var4)+(0.262439*input$var5)+(-0.008884*input$var6)+(0.289946*input$var8)+(0.401927*input$var10)+(23.972666*input$var1*input$var3)+(7.880937*input$var3*input$var4)+(-0.552321*input$var5*input$var6))/12
  x1<- ifelse(x1<0, 0, x1)
  x2<-(323.607465+(-51.512901*input$var1)+(-27.4532*input$var2)+(-3.694231*input$var3)+(0.396408*input$var4)+(0.241940*input$var5)+(-0.007776*input$var6)+(0.506097*input$var7)+(0.186941*input$var8)+(0.490624*input$var10)+(0.644206*input$var13)+(0.580897*input$var16)+(21.754459*input$var1*input$var3)+(7.632128*input$var3*input$var4)+(-0.539160*input$var5*input$var6))/12
  x2<- ifelse(x2<0, 0, x2)
  x7<-exp(3.848998+(5.792105*input$var1)+(3.607717*input$var2)+(0.604447*input$var3)+(0.188572*input$var4)+(-0.038029*input$var5)+(0.006577*input$var6)+(0.106083*input$var10)+(-0.024363*input$var11)+(-1.265091*input$var1*input$var3)+(-1.575834*input$var3*input$var4)+(0.104653*input$var5*input$var6))
  x7<- ifelse(x7<0, 0, x7)
  x8<-exp(3.839582+(5.654585*input$var1)+(3.342871*input$var2)+(0.569621*input$var3)+(0.169995*input$var4)+(-0.04951*input$var5)+(0.004531*input$var6)+(0.196799*input$var7)+(0.119367*input$var10)+(-0.024289*input$var11)+(0.102577*input$var13)+(0.085716*input$var16)+(-1.354496*input$var1*input$var3)+(-1.510316*input$var3*input$var4)+(0.096756*input$var5*input$var6))
  x8<- ifelse(x8<0, 0, x8)
  paste("- Birth cohort (including HIV-unexposed, HIV-exposed uninfected, and HIV-infected infants): US$",round((x8-x7)/(x2-x1),digits=0),"per life-year gained")
})
output$selected_var1<-renderText({
  # True positives EID
  x1<-(15270.4+(-334878.71*input$var1)+(-192881.33*input$var2)+(-126190.67*input$var3)+(323434.89*input$var4)+(-2775.95*input$var5)+(-230.83*input$var6)+(-130704.82*input$var8)+(-125659.45*input$var10)+(6325.04*input$var11)+(13440.66*input$var1*input$var2)+(661110.91*input$var1*input$var3)+(-589432.99*input$var1*input$var4)+(51753.78*input$var1*input$var5)+(-119.08*input$var1*input$var6)+(627615.44*input$var1*input$var8)+(657164.02*input$var1*input$var10)+(-19863.29*input$var1*input$var11)+(133310.71*input$var2*input$var3)+(53295.85*input$var2*input$var4)+(-175559.47*input$var2*input$var5)+(480.93*input$var2*input$var6)+(63427.72*input$var2*input$var8)+(72710.15*input$var2*input$var10)+(41938.50*input$var2*input$var11)+(-233500.26*input$var3*input$var4)+(5864.09*input$var3*input$var5)+(123.64*input$var3*input$var6)+(243883.19*input$var3*input$var8)+(256487.16*input$var3*input$var10)+(-11717.91*input$var3*input$var11)+(-25768.83*input$var4*input$var5)+(910.75*input$var4*input$var6)+(-223267.33*input$var4*input$var8)+(-221972.72*input$var4*input$var10)+(11362.82*input$var4*input$var11)+(583.62*input$var5*input$var6)+(16204.03*input$var5*input$var8)+(11840.49*input$var5*input$var10)+(-981.70*input$var5*input$var11)+(-212.77*input$var6*input$var8)+(-570.84*input$var6*input$var10)+(-60.11*input$var6*input$var11)+(246727.00*input$var8*input$var10)+(-5110.23*input$var8*input$var11)+(-10600.74*input$var10*input$var11))/300
  x1<- ifelse(x1<0, 0, x1)
  # True positive ScT
  x2<-(-88677.58+(-543994.06*input$var1)+(-301203.45*input$var2)+(307294.38*input$var3)+(392302.83*input$var4)+(-8976.84*input$var5)+(-1280.14*input$var6)+(-165536.59*input$var7)+(30530.62*input$var8)+(-151444.74*input$var10)+(21023.46*input$var11)+(-108041.02*input$var13)+(-87281.56*input$var16)+(25674.20*input$var17)+(-1108.21*input$var25)+(31287.53*input$var1*input$var2)+(-41315.99*input$var1*input$var3)+(-743296.83*input$var1*input$var4)+(31842.03*input$var1*input$var5)+(355.94*input$var1*input$var6)+(772422.08*input$var1*input$var7)+(377678.37*input$var1*input$var8)+(869155.91*input$var1*input$var10)+(-38000.26*input$var1*input$var11)+(977364.48*input$var1*input$var13)+(834912.68*input$var1*input$var16)+(-43537.13*input$var1*input$var17)+(5374.52*input$var1*input$var25)+(55473.78*input$var2*input$var3)+(265454.59*input$var2*input$var4)+(-24116.86*input$var2*input$var5)+(7641.71*input$var2*input$var6)+(94142.34*input$var2*input$var7)+(-63395.84*input$var2*input$var8)+(53285.66*input$var2*input$var10)+(3734.04*input$var2*input$var11)+(96138.67*input$var2*input$var13)+(8563.88*input$var2*input$var16)+(-23683.72*input$var2*input$var17)+(63515.79*input$var2*input$var25)+(-319701.95*input$var3*input$var4)+(27761.38*input$var3*input$var5)+(-337.72*input$var3*input$var6)+(-162770.20*input$var3*input$var7)+(152721.85*input$var3*input$var8)+(339750.24*input$var3*input$var10)+(-16279.22*input$var3*input$var11)+(-263617.35*input$var3*input$var13)+(-355086.06*input$var3*input$var16)+(13009.30*input$var3*input$var17)+(-13490.32*input$var3*input$var25)+(-22111.61*input$var4*input$var5)+(390.53*input$var4*input$var6)+(-38213.48*input$var4*input$var7)+(-163758.81*input$var4*input$var8)+(-303828.46*input$var4*input$var10)+(6663.06*input$var4*input$var11)+(-38670.16*input$var4*input$var13)+(32287.30*input$var4*input$var16)+(-2982.24*input$var4*input$var17)+(21396.23*input$var4*input$var25)+(1421.46*input$var5*input$var6)+(-2955.82*input$var5*input$var7)+(14776.71*input$var5*input$var8)+(2870.90*input$var5*input$var10)+(-7055.06*input$var5*input$var11)+(-7576.74*input$var5*input$var13)+(25462.43*input$var5*input$var16)+(-3857.10*input$var5*input$var17)+(5095.05*input$var5*input$var25)+(1878.60*input$var6*input$var7)+(-752.10*input$var6*input$var8)+(-139.68*input$var6*input$var10)+(-253.72*input$var6*input$var11)+(389.25*input$var6*input$var13)+(-456.54*input$var6*input$var16)+(91.82*input$var6*input$var17)+(600.69*input$var6*input$var25)+(-59352.98*input$var7*input$var8)+(82205.91*input$var7*input$var10)+(4048.37*input$var7*input$var11)+(278417.56*input$var7*input$var13)+(215379.88*input$var7*input$var16)+(-14473.13*input$var7*input$var17)+(4385.50*input$var7*input$var25)+(152316.66*input$var8*input$var10)+(-2345.99*input$var8*input$var11)+(-86867.82*input$var8*input$var13)+(-2963.44*input$var8*input$var16)+(-4277.69*input$var8*input$var17)+(-7037.26*input$var8*input$var25)+(-9399.04*input$var10*input$var11)+(76785.30*input$var10*input$var13)+(3568.55*input$var10*input$var16)+(-2096.32*input$var10*input$var17)+(-12995.81*input$var10*input$var25)+(-6137.75*input$var11*input$var13)+(-4199.06*input$var11*input$var16)+(374.60*input$var11*input$var17)+(-4668.57*input$var11*input$var25)+(338597.98*input$var13*input$var16)+(-14987.38*input$var13*input$var17)+(-2069.81*input$var13*input$var25)+(-16978.14*input$var16*input$var17)+(19394.61*input$var16*input$var25)+(-4628.56*input$var17*input$var25))/300
  x2<- ifelse(x2<0, 0, x2)
  paste("- Infants identified with HIV by testing/screening program:",round(x2-x1,digits=0),"additional infections identified per 100,000 births (Figure 1)")
})
output$selected_var2<-renderText({
  #MTCT EID
  x3<-(-265456.9+(8381744.4*input$var1)+(-2819834.8*input$var2)+(740063.2*input$var3)+(788238.4*input$var4)+(-586894.3*input$var5)+(-19469.3*input$var6)+(47459.6*input$var8)+(9422.5*input$var10)+(2329.4*input$var11)+(-4221883.3*input$var1*input$var2)+(-3402586*input$var1*input$var3)+(-3430854.1*input$var1*input$var4)+(937650.8*input$var1*input$var5)+(29666.2*input$var1*input$var6)+(3327.2*input$var1*input$var8)+(-27441.2*input$var1*input$var10)+(11289.90*input$var1*input$var11)+(239165.6*input$var2*input$var3)+(412832.2*input$var2*input$var4)+(8270901.8*input$var2*input$var5)+(366210.2*input$var2*input$var6)+(-240630.7*input$var2*input$var8)+(-293880*input$var2*input$var10)+(102606*input$var2*input$var11)+(-1321143.7*input$var3*input$var4)+(-114150.6*input$var3*input$var5)+(-2755.2*input$var3*input$var6)+(-31190.3*input$var3*input$var8)+(18511.3*input$var3*input$var10)+(-5205.1*input$var3*input$var11)+(-157333.3*input$var4*input$var5)+(-4867.5*input$var4*input$var6)+(-25400.1*input$var4*input$var8)+(-273*input$var4*input$var10)+(-5225.1*input$var4*input$var11)+(101566.4*input$var5*input$var6)+(36154.8*input$var5*input$var8)+(-21748.7*input$var5*input$var10)+(-7952.1*input$var5*input$var11)+(-2876.8*input$var6*input$var8)+(283.1*input$var6*input$var10)+(-466.6*input$var6*input$var11)+(5224.80*input$var8*input$var10)+(7558.2*input$var8*input$var11)+(-3040.6*input$var10*input$var11))/300
  x3<- ifelse(x3<0, 0, x3)
  #MTCT ScT
  x4<-(-384500+(8529000*input$var1)+(-3090000*input$var2)+(726400*input$var3)+(845600*input$var4)+(-475700*input$var5)+(-16500*input$var6)+(-25870*input$var7)+(51460*input$var8)+(-10730*input$var10)+(10240*input$var11)+(79670*input$var13)+(96250*input$var16)+(1633*input$var17)+(143700*input$var25)+(-4034000*input$var1*input$var2)+(-3366000*input$var1*input$var3)+(-3467000*input$var1*input$var4)+(884500*input$var1*input$var5)+(26630*input$var1*input$var6)+(48690*input$var1*input$var7)+(-2596*input$var1*input$var8)+(-52090*input$var1*input$var10)+(11290*input$var1*input$var11)+(-115900*input$var1*input$var13)+(-104900*input$var1*input$var16)+(-22010*input$var1*input$var17)+(16740*input$var1*input$var25)+(281400*input$var2*input$var3)+(398300*input$var2*input$var4)+(8177000*input$var2*input$var5)+(360000*input$var2*input$var6)+(320400*input$var2*input$var7)+(-204200*input$var2*input$var8)+(-302000*input$var2*input$var10)+(121100*input$var2*input$var11)+(-249100*input$var2*input$var13)+(132800*input$var2*input$var16)+(66460*input$var2*input$var17)+(86770*input$var2*input$var25)+(-1309000*input$var3*input$var4)+(-95090*input$var3*input$var5)+(-1781*input$var3*input$var6)+(33940*input$var3*input$var7)+(-31420*input$var3*input$var8)+(11220*input$var3*input$var10)+(-4062*input$var3*input$var11)+(-15580*input$var3*input$var13)+(-27580*input$var3*input$var16)+(-2892*input$var3*input$var17)+(-1471*input$var3*input$var25)+(-179800*input$var4*input$var5)+(-6465*input$var4*input$var6)+(11750*input$var4*input$var7)+(-25900*input$var4*input$var8)+(-168.4*input$var4*input$var10)+(-1778*input$var4*input$var11)+(9518*input$var4*input$var13)+(-47000*input$var4*input$var16)+(-5007*input$var4*input$var17)+(-52310*input$var4*input$var25)+(98930*input$var5*input$var6)+(46270*input$var5*input$var7)+(37210*input$var5*input$var8)+(-22370*input$var5*input$var10)+(-7393*input$var5*input$var11)+(-47480*input$var5*input$var13)+(-59100*input$var5*input$var16)+(-4859*input$var5*input$var17)+(-89970*input$var5*input$var25)+(-1414*input$var6*input$var7)+(-2863*input$var6*input$var8)+(482.3*input$var6*input$var10)+(-516.8*input$var6*input$var11)+(88.92*input$var6*input$var13)+(290*input$var6*input$var16)+(236.2*input$var6*input$var17)+(-2812*input$var6*input$var25)+(9004*input$var7*input$var8)+(9605*input$var7*input$var10)+(-13760*input$var7*input$var11)+(7462*input$var7*input$var13)+(-10600*input$var7*input$var16)+(105.5*input$var7*input$var17)+(-31150*input$var7*input$var25)+(12000*input$var8*input$var10)+(6470*input$var8*input$var11)+(5934*input$var8*input$var13)+(-7137*input$var8*input$var16)+(-4770*input$var8*input$var17)+(-11610*input$var8*input$var25)+(-1857*input$var10*input$var11)+(15700*input$var10*input$var13)+(2242*input$var10*input$var16)+(4899*input$var10*input$var17)+(-2247*input$var10*input$var25)+(-5869*input$var11*input$var13)+(-7568*input$var11*input$var16)+(3765*input$var11*input$var17)+(-4540*input$var11*input$var25)+(500.2*input$var13*input$var16)+(-6558*input$var13*input$var17)+(-64110*input$var13*input$var25)+(5915*input$var16*input$var17)+(-29890*input$var16*input$var25)+(-3470*input$var17*input$var25))/300
  x4<- ifelse(x4<0, 0, x4)
  paste("- Mother-to-child transmissions:",round(x3-x4,digits=0),"infections avoided (by the cessation of breastfeeding) per 100,000 births (Figure 2)")
})
output$selected_var3<-renderText({
  # Alive and on ART EID
  x5<-(-67680+(1662000*input$var1)+(-247800*input$var2)+(70470*input$var3)+(367800*input$var4)+(-19180*input$var5)+(-1311*input$var6)+(-79570*input$var8)+(-75960*input$var10)+(5870*input$var11)+(-285900*input$var1*input$var2)+(-294800*input$var1*input$var3)+(-1128000*input$var1*input$var4)+(153500*input$var1*input$var5)+(1779*input$var1*input$var6)+(400800*input$var1*input$var8)+(419400*input$var1*input$var10)+(-10180*input$var1*input$var11)+(163500*input$var2*input$var3)+(65690*input$var2*input$var4)+(616500*input$var2*input$var5)+(20790*input$var2*input$var6)+(48430*input$var2*input$var8)+(20850*input$var2*input$var10)+(17090*input$var2*input$var11)+(-445700*input$var3*input$var4)+(-10680*input$var3*input$var5)+(-457.1*input$var3*input$var6)+(154400*input$var3*input$var8)+(165000*input$var3*input$var10)+(-6240*input$var3*input$var11)+(-30860*input$var4*input$var5)+(477.6*input$var4*input$var6)+(-148600*input$var4*input$var8)+(-145200*input$var4*input$var10)+(5008*input$var4*input$var11)+(6312*input$var5*input$var6)+(10910*input$var5*input$var8)+(4253*input$var5*input$var10)+(-2674*input$var5*input$var11)+(-33.47*input$var6*input$var8)+(-336.9*input$var6*input$var10)+(-91.01*input$var6*input$var11)+(158500*input$var8*input$var10)+(-3229*input$var8*input$var11)+(-6770*input$var10*input$var11))/300
  x5<- ifelse(x5<0, 0, x5)
  # Alive and on ART ScT
  x6<-(-132200+(1513000*input$var1)+(-350800*input$var2)+(366700*input$var3)+(415300*input$var4)+(-19750*input$var5)+(-1887*input$var6)+(-113400*input$var7)+(31900*input$var8)+(-95690*input$var10)+(15430*input$var11)+(-73780*input$var13)+(-70520*input$var16)+(12710*input$var17)+(1450*input$var25)+(-280200*input$var1*input$var2)+(-767900*input$var1*input$var3)+(-1242000*input$var1*input$var4)+(138200*input$var1*input$var5)+(2025*input$var1*input$var6)+(509900*input$var1*input$var7)+(223300*input$var1*input$var8)+(571600*input$var1*input$var10)+(-22570*input$var1*input$var11)+(678500*input$var1*input$var13)+(577300*input$var1*input$var16)+(-26600*input$var1*input$var17)+(15640*input$var1*input$var25)+(116200*input$var2*input$var3)+(210000*input$var2*input$var4)+(701400*input$var2*input$var5)+(25700*input$var2*input$var6)+(41740*input$var2*input$var7)+(-32510*input$var2*input$var8)+(7608*input$var2*input$var10)+(-8987*input$var2*input$var11)+(59610*input$var2*input$var13)+(72410*input$var2*input$var16)+(-15480*input$var2*input$var17)+(58610*input$var2*input$var25)+(-505600*input$var3*input$var4)+(6601*input$var3*input$var5)+(-686.8*input$var3*input$var6)+(-103900*input$var3*input$var7)+(90540*input$var3*input$var8)+(224300*input$var3*input$var10)+(-9747*input$var3*input$var11)+(-179600*input$var3*input$var13)+(-239000*input$var3*input$var16)+(5705*input$var3*input$var17)+(-13490*input$var3*input$var25)+(-30980*input$var4*input$var5)+(56.17*input$var4*input$var6)+(-27530*input$var4*input$var7)+(-107400*input$var4*input$var8)+(-203200*input$var4*input$var10)+(2039*input$var4*input$var11)+(-28620*input$var4*input$var13)+(20250*input$var4*input$var16)+(-590.3*input$var4*input$var17)+(19160*input$var4*input$var25)+(6827*input$var5*input$var6)+(-4444*input$var5*input$var7)+(9159*input$var5*input$var8)+(-399.8*input$var5*input$var10)+(-6590*input$var5*input$var11)+(-12370*input$var5*input$var13)+(21650*input$var5*input$var16)+(-2877*input$var5*input$var17)+(2801*input$var5*input$var25)+(1312*input$var6*input$var7)+(-436.4*input$var6*input$var8)+(-55.18*input$var6*input$var10)+(-213.1*input$var6*input$var11)+(267.3*input$var6*input$var13)+(-523.2*input$var6*input$var16)+(101.1*input$var6*input$var17)+(192.6*input$var6*input$var25)+(-43030*input$var7*input$var8)+(58040*input$var7*input$var10)+(2990*input$var7*input$var11)+(187600*input$var7*input$var13)+(144500*input$var7*input$var16)+(-7495*input$var7*input$var17)+(2781*input$var7*input$var25)+(92810*input$var8*input$var10)+(-999.5*input$var8*input$var11)+(-64670*input$var8*input$var13)+(1387*input$var8*input$var16)+(-1088*input$var8*input$var17)+(-6327*input$var8*input$var25)+(-6331*input$var10*input$var11)+(55020*input$var10*input$var13)+(1048*input$var10*input$var16)+(-360.8*input$var10*input$var17)+(-10390*input$var10*input$var25)+(-4488*input$var11*input$var13)+(-2530*input$var11*input$var16)+(539.6*input$var11*input$var17)+(-3756*input$var11*input$var25)+(232900*input$var13*input$var16)+(-6385*input$var13*input$var17)+(-5463*input$var13*input$var25)+(-8340*input$var16*input$var17)+(14030*input$var16*input$var25)+(-3459*input$var17*input$var25))/300
  x6<- ifelse(x6<0, 0, x6)
  paste("- Infants who are alive and on ART:",round(x6-x5,digits=0),"additional infants on ART by one year of age per 100,000 births (Figure 3)")
})
output$selected_var4<-renderText({
  # Number of HIV-related deaths EID
  x3<-(-155500+(3861000*input$var1)+(-220700*input$var2)+(337600*input$var3)+(233400*input$var4)+(-36930*input$var5)+(-2243*input$var6)+(42680*input$var8)+(40770*input$var10)+(-167.2*input$var11)+(-572000*input$var1*input$var2)+(-1632000*input$var1*input$var3)+(-1342000*input$var1*input$var4)+(230600*input$var1*input$var5)+(3804*input$var1*input$var6)+(-181900*input$var1*input$var8)+(-190500*input$var1*input$var10)+(15180*input$var1*input$var11)+(116200*input$var2*input$var3)+(50730*input$var2*input$var4)+(1489000*input$var2*input$var5)+(41970*input$var2*input$var6)+(7334*input$var2*input$var8)+(-61980*input$var2*input$var10)+(-29500*input$var2*input$var11)+(-529900*input$var3*input$var4)+(-30840*input$var3*input$var5)+(-1107*input$var3*input$var6)+(-73370*input$var3*input$var8)+(-71180*input$var3*input$var10)+(7468*input$var3*input$var11)+(-21720*input$var4*input$var5)+(-480.3*input$var4*input$var6)+(52090*input$var4*input$var8)+(58190*input$var4*input$var10)+(-9329*input$var4*input$var11)+(11880*input$var5*input$var6)+(-2364*input$var5*input$var8)+(-10010*input$var5*input$var10)+(-3641*input$var5*input$var11)+(239*input$var6*input$var8)+(234.7*input$var6*input$var10)+(-87.06*input$var6*input$var11)+(-69150*input$var8*input$var10)+(3284*input$var8*input$var11)+(4920*input$var10*input$var11))/300
  x3<- ifelse(x3<0, 0, x3)
  # Number of HIV-related deaths ScT
  x4<-(-118500+(3904000*input$var1)+(-242200*input$var2)+(224300*input$var3)+(216500*input$var4)+(-29660*input$var5)+(-1710*input$var6)+(41160*input$var7)+(6664*input$var8)+(42890*input$var10)+(-5789*input$var11)+(26910*input$var13)+(2137*input$var16)+(-13080*input$var17)+(6623*input$var25)+(-582900*input$var1*input$var2)+(-1441000*input$var1*input$var3)+(-1316000*input$var1*input$var4)+(233000*input$var1*input$var5)+(3526*input$var1*input$var6)+(-231600*input$var1*input$var7)+(-126100*input$var1*input$var8)+(-236300*input$var1*input$var10)+(24690*input$var1*input$var11)+(-238200*input$var1*input$var13)+(-205700*input$var1*input$var16)+(13510*input$var1*input$var17)+(21950*input$var1*input$var25)+(143700*input$var2*input$var3)+(-9283*input$var2*input$var4)+(1434000*input$var2*input$var5)+(40030*input$var2*input$var6)+(-69020*input$var2*input$var7)+(51120*input$var2*input$var8)+(-63390*input$var2*input$var10)+(-21820*input$var2*input$var11)+(-34900*input$var2*input$var13)+(132200*input$var2*input$var16)+(6630*input$var2*input$var17)+(4667*input$var2*input$var25)+(-508800*input$var3*input$var4)+(-32800*input$var3*input$var5)+(-847.9*input$var3*input$var6)+(50870*input$var3*input$var7)+(-51860*input$var3*input$var8)+(-89490*input$var3*input$var10)+(10040*input$var3*input$var11)+(68570*input$var3*input$var13)+(99150*input$var3*input$var16)+(-8262*input$var3*input$var17)+(-5396*input$var3*input$var25)+(-27520*input$var4*input$var5)+(-508.5*input$var4*input$var6)+(7870*input$var4*input$var7)+(38050*input$var4*input$var8)+(76600*input$var4*input$var10)+(-9656*input$var4*input$var11)+(7098*input$var4*input$var13)+(-11370*input$var4*input$var16)+(3775*input$var4*input$var17)+(4447*input$var4*input$var25)+(11560*input$var5*input$var6)+(-3525*input$var5*input$var7)+(-3066*input$var5*input$var8)+(-5191*input$var5*input$var10)+(-1889*input$var5*input$var11)+(-11340*input$var5*input$var13)+(3710*input$var5*input$var16)+(67.69*input$var5*input$var17)+(-1720*input$var5*input$var25)+(-373.1*input$var6*input$var7)+(327.7*input$var6*input$var8)+(126*input$var6*input$var10)+(-31.69*input$var6*input$var11)+(-101.1*input$var6*input$var13)+(-270.1*input$var6*input$var16)+(39.76*input$var6*input$var17)+(-552.5*input$var6*input$var25)+(12380*input$var7*input$var8)+(-18300*input$var7*input$var10)+(908.5*input$var7*input$var11)+(-71820*input$var7*input$var13)+(-58020*input$var7*input$var16)+(5753*input$var7*input$var17)+(-504*input$var7*input$var25)+(-46730*input$var8*input$var10)+(1095*input$var8*input$var11)+(11910*input$var8*input$var13)+(5796*input$var8*input$var16)+(4480*input$var8*input$var17)+(-3275*input$var8*input$var25)+(6020*input$var10*input$var11)+(-16570*input$var10*input$var13)+(-4129*input$var10*input$var16)+(2449*input$var10*input$var17)+(-654.5*input$var10*input$var25)+(2504*input$var11*input$var13)+(1616*input$var11*input$var16)+(434.1*input$var11*input$var17)+(-280.8*input$var11*input$var25)+(-84390*input$var13*input$var16)+(9837*input$var13*input$var17)+(-8290*input$var13*input$var25)+(9273*input$var16*input$var17)+(-2966*input$var16*input$var25)+(153*input$var17*input$var25))/300
  x4<- ifelse(x4<0, 0, x4)
  paste("- Number of lives saved:",round(x3-x4,digits=0),"HIV-related deaths avoided by one year of age per 100,000 births (Figure 4)")
})
output$selected_var10<-renderText({
  # Life expectancy of HIV+ EID
  x1<-(103.55112+(18.89518*input$var1)+(5.69347*input$var2)+(-5.17427*input$var3)+(-0.95222*input$var4)+(2.42947*input$var5)+(0.78053*input$var6)+(0.21538*input$var8)+(-1.84537*input$var10)+(1.05578*input$var11)+(-212.25509*input$var1*input$var2)+(2.90019*input$var1*input$var3)+(-6.9106*input$var1*input$var4)+(-31.79417*input$var1*input$var5)+(-4.07133*input$var1*input$var6)+(8.59473*input$var1*input$var8)+(12.80056*input$var1*input$var10)+(-0.07257*input$var1*input$var11)+(-2.68022*input$var2*input$var3)+(18.49384*input$var2*input$var4)+(73.22695*input$var2*input$var5)+(7.98618*input$var2*input$var6)+(-15.21883*input$var2*input$var8)+(-17.10133*input$var2*input$var10)+(3.24426*input$var2*input$var11)+(3.51554*input$var3*input$var4)+(-3.96379*input$var3*input$var5)+(0.10737*input$var3*input$var6)+(19.8484*input$var3*input$var8)+(21.51864*input$var3*input$var10)+(-1.9527*input$var3*input$var11)+(4.36481*input$var4*input$var5)+(0.48971*input$var4*input$var6)+(-9.579*input$var4*input$var8)+(-7.20213*input$var4*input$var10)+(0.61172*input$var4*input$var11)+(2.50878*input$var5*input$var6)+(-5.43117*input$var5*input$var8)+(-5.71404*input$var5*input$var10)+(0.32699*input$var5*input$var11)+(-0.25604*input$var6*input$var8)+(-0.27759*input$var6*input$var10)+(0.02947*input$var6*input$var11)+(17.02486*input$var8*input$var10)+(-1.2754*input$var8*input$var11)+(-1.58885*input$var10*input$var11))/12
  x1<- ifelse(x1<0, 0, x1)
  # Life expectancy of HIV+ ScT
  x2<-(93.91265+(6.4629*input$var1)+(42.96596*input$var2)+(4.13937*input$var3)+(-2.06569*input$var4)+(10.52131*input$var5)+(1.11319*input$var6)+(-0.55176*input$var7)+(5.78487*input$var8)+(0.1614*input$var10)+(1.60121*input$var11)+(6.3736*input$var13)+(5.00768*input$var16)+(1.19656*input$var17)+(1.1679*input$var25)+(-182.64659*input$var1*input$var2)+(0.63421*input$var1*input$var3)+(-4.66249*input$var1*input$var4)+(-27.06059*input$var1*input$var5)+(-3.45872*input$var1*input$var6)+(7.88848*input$var1*input$var7)+(5.55663*input$var1*input$var8)+(16.64055*input$var1*input$var10)+(-0.32348*input$var1*input$var11)+(9.69546*input$var1*input$var13)+(7.74224*input$var1*input$var16)+(-1.00478*input$var1*input$var17)+(-1.11542*input$var1*input$var25)+(-6.12316*input$var2*input$var3)+(13.66839*input$var2*input$var4)+(51.97434*input$var2*input$var5)+(7.11782*input$var2*input$var6)+(-22.29521*input$var2*input$var7)+(-15.73987*input$var2*input$var8)+(-23.39634*input$var2*input$var10)+(0.8723*input$var2*input$var11)+(-25.64835*input$var2*input$var13)+(-19.24065*input$var2*input$var16)+(1.29382*input$var2*input$var17)+(2.15349*input$var2*input$var25)+(3.77628*input$var3*input$var4)+(-1.29836*input$var3*input$var5)+(0.15184*input$var3*input$var6)+(-4.32122*input$var3*input$var7)+(13.41489*input$var3*input$var8)+(28.00259*input$var3*input$var10)+(-2.32152*input$var3*input$var11)+(-10.37833*input$var3*input$var13)+(-17.3604*input$var3*input$var16)+(0.97891*input$var3*input$var17)+(-0.3967*input$var3*input$var25)+(2.73848*input$var4*input$var5)+(0.33725*input$var4*input$var6)+(0.87948*input$var4*input$var7)+(-6.92886*input$var4*input$var8)+(-10.78241*input$var4*input$var10)+(0.41584*input$var4*input$var11)+(3.02632*input$var4*input$var13)+(6.73991*input$var4*input$var16)+(-0.44437*input$var4*input$var17)+(0.20556*input$var4*input$var25)+(2.16755*input$var5*input$var6)+(-6.84868*input$var5*input$var7)+(-4.14694*input$var5*input$var8)+(-7.32246*input$var5*input$var10)+(0.47423*input$var5*input$var11)+(-7.2766*input$var5*input$var13)+(-4.71288*input$var5*input$var16)+(0.53135*input$var5*input$var17)+(-1.32287*input$var5*input$var25)+(-0.28767*input$var6*input$var7)+(-0.16157*input$var6*input$var8)+(-0.33254*input$var6*input$var10)+(0.02295*input$var6*input$var11)+(-0.39816*input$var6*input$var13)+(-0.29441*input$var6*input$var16)+(0.02321*input$var6*input$var17)+(-0.01629*input$var6*input$var25)+(-3.97431*input$var7*input$var8)+(5.61466*input$var7*input$var10)+(0.28868*input$var7*input$var11)+(17.91655*input$var7*input$var13)+(14.88227*input$var7*input$var16)+(-0.81459*input$var7*input$var17)+(0.21683*input$var7*input$var25)+(11.21629*input$var8*input$var10)+(-0.81844*input$var8*input$var11)+(-4.68093*input$var8*input$var13)+(-0.83926*input$var8*input$var16)+(-0.31374*input$var8*input$var17)+(0.74971*input$var8*input$var25)+(-1.77725*input$var10*input$var11)+(4.04567*input$var10*input$var13)+(0.22659*input$var10*input$var16)+(-0.4628*input$var10*input$var17)+(-2.18263*input$var10*input$var25)+(-0.59154*input$var11*input$var13)+(-0.64929*input$var11*input$var16)+(0.04537*input$var11*input$var17)+(-0.2328*input$var11*input$var25)+(21.61058*input$var13*input$var16)+(-1.51066*input$var13*input$var17)+(-0.43308*input$var13*input$var25)+(-1.81288*input$var16*input$var17)+(2.24701*input$var16*input$var25)+(-0.19267*input$var17*input$var25))/12
  x2<- ifelse(x2<0, 0, x2)
  paste("- Life expectancy (undiscounted): Mean improvement of",round(x2-x1,digits=2),"years (Figure 5)")
})
output$selected_var6<-renderText({
  #LmsEID
  x1<-325.96898+(-65.64293*input$var1)+(0.85028*input$var2)+(-5.42326*input$var3)+(-4.15119*input$var4)+(2.91058*input$var5)+(0.10749*input$var6)+(-0.55402*input$var8)+(-0.36339*input$var10)+(-0.05702*input$var11)+(33.41571*input$var1*input$var2)+(24.59938*input$var1*input$var3)+(21.38804*input$var1*input$var4)+(-5.72805*input$var1*input$var5)+(-0.17202*input$var1*input$var6)+(1.99266*input$var1*input$var8)+(2.09233*input$var1*input$var10)+(-0.11179*input$var1*input$var11)+(-1.39281*input$var2*input$var3)+(-0.95314*input$var2*input$var4)+(-45.75619*input$var2*input$var5)+(-2.03017*input$var2*input$var6)+(-1.25262*input$var2*input$var8)+(0.40957*input$var2*input$var10)+(0.29101*input$var2*input$var11)+(8.47016*input$var3*input$var4)+(0.76250*input$var3*input$var5)+(0.03294*input$var3*input$var6)+(0.84607*input$var3*input$var8)+(0.76402*input$var3*input$var10)+(-0.04576*input$var3*input$var11)+(0.76045*input$var4*input$var5)+(0.02487*input$var4*input$var6)+(-0.53845*input$var4*input$var8)+(-0.70971*input$var4*input$var10)+(0.09412*input$var4*input$var11)+(-0.57044*input$var5*input$var6)+(0.13468*input$var5*input$var8)+(0.10450*input$var5*input$var10)+(0.05676*input$var5*input$var11)+(-0.00346*input$var6*input$var8)+(-0.00874*input$var6*input$var10)+(0.00164*input$var6*input$var11)+(0.78452*input$var8*input$var10)+(0.01209*input$var8*input$var11)+(-0.04867*input$var10*input$var11)
  x1<- ifelse(x1<0, 0, x1)
  #LmsScT
  x2<-325.8+(-66.64*input$var1)+(1.119*input$var2)+(-4*input$var3)+(-4.04*input$var4)+(2.71*input$var5)+(0.08868*input$var6)+(-0.56870*input$var7)+(-0.10810*input$var8)+(-0.5796*input$var10)+(0.00581*input$var11)+(-0.47840*input$var13)+(-0.05943*input$var16)+(0.07171*input$var17)+(-0.22370*input$var25)+(33.93*input$var1*input$var2)+(22.41*input$var1*input$var3)+(21.21*input$var1*input$var4)+(-5.528*input$var1*input$var5)+(-0.1625*input$var1*input$var6)+(2.969*input$var1*input$var7)+(1.319*input$var1*input$var8)+(2.644*input$var1*input$var10)+(-0.2068*input$var1*input$var11)+(2.863*input$var1*input$var13)+(2.344*input$var1*input$var16)+(-0.05278*input$var1*input$var17)+(-0.4096*input$var1*input$var25)+(-1.631*input$var2*input$var3)+(-0.1795*input$var2*input$var4)+(-44.87*input$var2*input$var5)+(-1.98*input$var2*input$var6)+(1.236*input$var2*input$var7)+(-1.756*input$var2*input$var8)+(0.41140*input$var2*input$var10)+(0.2513*input$var2*input$var11)+(0.3607*input$var2*input$var13)+(-2.627*input$var2*input$var16)+(-0.2477*input$var2*input$var17)+(-0.1358*input$var2*input$var25)+(8.177*input$var3*input$var4)+(0.6897*input$var3*input$var5)+(0.02711*input$var3*input$var6)+(-0.6196*input$var3*input$var7)+(0.598*input$var3*input$var8)+(0.9834*input$var3*input$var10)+(-0.07017*input$var3*input$var11)+(-0.7655*input$var3*input$var13)+(-1.122*input$var3*input$var16)+(0.06395*input$var3*input$var17)+(0.04591*input$var3*input$var25)+(0.9303*input$var4*input$var5)+(0.03151*input$var4*input$var6)+(-0.0914*input$var4*input$var7)+(-0.3743*input$var4*input$var8)+(-0.9214*input$var4*input$var10)+(0.0905*input$var4*input$var11)+(-0.0536*input$var4*input$var13)+(0.1172*input$var4*input$var16)+(-0.03714*input$var4*input$var17)+(-0.03*input$var4*input$var25)+(-0.559*input$var5*input$var6)+(0.08266*input$var5*input$var7)+(0.1511*input$var5*input$var8)+(0.0587*input$var5*input$var10)+(0.03836*input$var5*input$var11)+(0.1127*input$var5*input$var13)+(-0.1129*input$var5*input$var16)+(0.00048*input$var5*input$var17)+(0.1121*input$var5*input$var25)+(0.00778*input$var6*input$var7)+(-0.00449*input$var6*input$var8)+(-0.00756*input$var6*input$var10)+(0.00106*input$var6*input$var11)+(0.00659*input$var6*input$var13)+(0.00449*input$var6*input$var16)+(-0.00016*input$var6*input$var17)+(0.01242*input$var6*input$var25)+(-0.1936*input$var7*input$var8)+(0.2752*input$var7*input$var10)+(-0.0318*input$var7*input$var11)+(0.8034*input$var7*input$var13)+(0.5899*input$var7*input$var16)+(-0.04943*input$var7*input$var17)+(-0.0051*input$var7*input$var25)+(0.5247*input$var8*input$var10)+(0.0247*input$var8*input$var11)+(-0.1428*input$var8*input$var13)+(-0.05491*input$var8*input$var16)+(-0.05702*input$var8*input$var17)+(0.07405*input$var8*input$var25)+(-0.05598*input$var10*input$var11)+(0.2616*input$var10*input$var13)+(0.05041*input$var10*input$var16)+(0.00479*input$var10*input$var17)+(0.1204*input$var10*input$var25)+(-0.01216*input$var11*input$var13)+(0.00154*input$var11*input$var16)+(-0.00403*input$var11*input$var17)+(-0.00442*input$var11*input$var25)+(0.8933*input$var13*input$var16)+(-0.07485*input$var13*input$var17)+(0.1575*input$var13*input$var25)+(-0.03179*input$var16*input$var17)+(0.04996*input$var16*input$var25)+(0.01685*input$var17*input$var25)
  x2<- ifelse(x2<0, 0, x2)
  #CostEID
  x3<--19.03+(637*input$var1)+(-1620*input$var2)+(255.7*input$var3)+(361.4*input$var4)+(-365.1*input$var5)+(-15.39*input$var6)+(-31.63*input$var8)+(-31.76*input$var10)+(5.6870*input$var11)+(-0.5049*input$var18)+(-0.3282*input$var20)+(0.0026*input$var21)+(-1051*input$var1*input$var2)+(-613*input$var1*input$var3)+(-812.3*input$var1*input$var4)+(227.6*input$var1*input$var5)+(8.08*input$var1*input$var6)+(90.88*input$var1*input$var8)+(85.64*input$var1*input$var10)+(-9.555*input$var1*input$var11)+(11.51*input$var1*input$var18)+(8.226*input$var1*input$var20)+(0.5837*input$var1*input$var21)+(88.91*input$var2*input$var3)+(101.9*input$var2*input$var4)+(2187*input$var2*input$var5)+(108.1*input$var2*input$var6)+(130*input$var2*input$var8)+(0.3141*input$var2*input$var10)+(1.133*input$var2*input$var11)+(8.958*input$var2*input$var18)+(4.949*input$var2*input$var20)+(0.3584*input$var2*input$var21)+(-330.1*input$var3*input$var4)+(-30.67*input$var3*input$var5)+(-1.561*input$var3*input$var6)+(32.54*input$var3*input$var8)+(33.97*input$var3*input$var10)+(-2.339*input$var3*input$var11)+(-1.041*input$var3*input$var18)+(-0.6619*input$var3*input$var20)+(-0.0642*input$var3*input$var21)+(-45.63*input$var4*input$var5)+(-0.94*input$var4*input$var6)+(-30.41*input$var4*input$var8)+(-23.24*input$var4*input$var10)+(-0.5821*input$var4*input$var11)+(-1.538*input$var4*input$var18)+(-1.13*input$var4*input$var20)+(-0.08*input$var4*input$var21)+(30.13*input$var5*input$var6)+(3.4070*input$var5*input$var8)+(-7.77*input$var5*input$var10)+(-3.75*input$var5*input$var11)+(2.1840*input$var5*input$var18)+(1.512*input$var5*input$var20)+(0.1083*input$var5*input$var21)+(0.0687*input$var6*input$var8)+(0.3533*input$var6*input$var10)+(-0.06*input$var6*input$var11)+(0.1094*input$var6*input$var18)+(0.0669*input$var6*input$var20)+(0.0051*input$var6*input$var21)+(28.89*input$var8*input$var10)+(-3.36*input$var8*input$var11)+(0.2090*input$var8*input$var18)+(0.1571*input$var8*input$var20)+(0.0012*input$var8*input$var21)+(-1.325*input$var10*input$var11)+(0.1175*input$var10*input$var18)+(0.2198*input$var10*input$var20)+(-0.0006*input$var10*input$var21)+(-0.0151*input$var11*input$var18)+(-0.0049*input$var11*input$var20)+(0.0018*input$var11*input$var21)+(0.0004*input$var18*input$var20)+(-0.0001*input$var18*input$var21)+(0.000012*input$var20*input$var21)
  x3<- ifelse(x3<0, 0, x3)
  #CostScT
  x4<--29.88+(579.4*input$var1)+(-1674*input$var2)+(331.9*input$var3)+(378.4*input$var4)+(-364*input$var5)+(-14.94*input$var6)+(-13.95*input$var7)+(-2.058*input$var8)+(-33.24*input$var10)+(6.182*input$var11)+(-21.17*input$var13)+(-57.1*input$var16)+(4.165*input$var17)+(1.046*input$var25)+(-0.9352*input$var18)+(0.6128*input$var19)+(-0.43*input$var20)+(0.01005*input$var21)+(-1037*input$var1*input$var2)+(-727.8*input$var1*input$var3)+(-845.1*input$var1*input$var4)+(203*input$var1*input$var5)+(7.504*input$var1*input$var6)+(62.44*input$var1*input$var7)+(58.31*input$var1*input$var8)+(114.1*input$var1*input$var10)+(-11.44*input$var1*input$var11)+(154.1*input$var1*input$var13)+(131.2*input$var1*input$var16)+(-10.06*input$var1*input$var17)+(26.82*input$var1*input$var25)+(12.66*input$var1*input$var18)+(-0.6394*input$var1*input$var19)+(8.881*input$var1*input$var20)+(0.5835*input$var1*input$var21)+(71.44*input$var2*input$var3)+(124.3*input$var2*input$var4)+(2195*input$var2*input$var5)+(108.9*input$var2*input$var6)+(-99.21*input$var2*input$var7)+(118*input$var2*input$var8)+(10.57*input$var2*input$var10)+(-6.466*input$var2*input$var11)+(65.95*input$var2*input$var13)+(123.7*input$var2*input$var16)+(21.75*input$var2*input$var17)+(-34.83*input$var2*input$var25)+(9.704*input$var2*input$var18)+(-0.4924*input$var2*input$var19)+(4.977*input$var2*input$var20)+(0.3472*input$var2*input$var21)+(-337.7*input$var3*input$var4)+(-20.33*input$var3*input$var5)+(-1.373*input$var3*input$var6)+(-25.79*input$var3*input$var7)+(16.44*input$var3*input$var8)+(48.76*input$var3*input$var10)+(-3.573*input$var3*input$var11)+(-41.72*input$var3*input$var13)+(-44.9*input$var3*input$var16)+(2.63*input$var3*input$var17)+(4.244*input$var3*input$var25)+(-1.353*input$var3*input$var18)+(-0.3198*input$var3*input$var19)+(-0.8434*input$var3*input$var20)+(-0.06211*input$var3*input$var21)+(-51.83*input$var4*input$var5)+(-1.475*input$var4*input$var6)+(-5.269*input$var4*input$var7)+(-23.05*input$var4*input$var8)+(-34.26*input$var4*input$var10)+(-0.4346*input$var4*input$var11)+(-3.35*input$var4*input$var13)+(7.076*input$var4*input$var16)+(-1.532*input$var4*input$var17)+(5.414*input$var4*input$var25)+(-1.643*input$var4*input$var18)+(0.06333*input$var4*input$var19)+(-1.171*input$var4*input$var20)+(-0.08339*input$var4*input$var21)+(29.78*input$var5*input$var6)+(-0.41120*input$var5*input$var7)+(4.13*input$var5*input$var8)+(-10.09*input$var5*input$var10)+(-4.651*input$var5*input$var11)+(-10.88*input$var5*input$var13)+(11.99*input$var5*input$var16)+(1.403*input$var5*input$var17)+(-8.296*input$var5*input$var25)+(2.199*input$var5*input$var18)+(0.2933*input$var5*input$var19)+(1.458*input$var5*input$var20)+(0.1091*input$var5*input$var21)+(0.06694*input$var6*input$var7)+(0.1105*input$var6*input$var8)+(0.4299*input$var6*input$var10)+(-0.05114*input$var6*input$var11)+(-0.5719*input$var6*input$var13)+(0.1509*input$var6*input$var16)+(0.07651*input$var6*input$var17)+(-0.1703*input$var6*input$var25)+(0.106*input$var6*input$var18)+(0.00488*input$var6*input$var19)+(0.06639*input$var6*input$var20)+(0.00486*input$var6*input$var21)+(-4.566*input$var7*input$var8)+(8.398*input$var7*input$var10)+(4.795*input$var7*input$var11)+(37.95*input$var7*input$var13)+(30.77*input$var7*input$var16)+(-3.951*input$var7*input$var17)+(0.09802*input$var7*input$var25)+(0.2588*input$var7*input$var18)+(0.6513*input$var7*input$var19)+(0.09499*input$var7*input$var20)+(-0.00109*input$var7*input$var21)+(15.2*input$var8*input$var10)+(-2.298*input$var8*input$var11)+(-19.12*input$var8*input$var13)+(1.216*input$var8*input$var16)+(1.84*input$var8*input$var17)+(-5.223*input$var8*input$var25)+(0.1183*input$var8*input$var18)+(-0.1951*input$var8*input$var19)+(0.1031*input$var8*input$var20)+(0.00255*input$var8*input$var21)+(-0.9935*input$var10*input$var11)+(5.032*input$var10*input$var13)+(-0.09891*input$var10*input$var16)+(0.1592*input$var10*input$var17)+(-4.319*input$var10*input$var25)+(0.20420*input$var10*input$var18)+(-0.04898*input$var10*input$var19)+(0.2718*input$var10*input$var20)+(-0.00432*input$var10*input$var21)+(-2.491*input$var11*input$var13)+(-0.6542*input$var11*input$var16)+(0.3382*input$var11*input$var17)+(0.4483*input$var11*input$var25)+(-0.02123*input$var11*input$var18)+(-0.06059*input$var11*input$var19)+(-0.01211*input$var11*input$var20)+(0.00209*input$var11*input$var21)+(54.36*input$var13*input$var16)+(-0.04295*input$var13*input$var17)+(-5.744*input$var13*input$var25)+(0.4111*input$var13*input$var18)+(-0.06323*input$var13*input$var19)+(0.1698*input$var13*input$var20)+(-0.00222*input$var13*input$var21)+(-6.228*input$var16*input$var17)+(0.5095*input$var16*input$var25)+(0.4626*input$var16*input$var18)+(-0.03676*input$var16*input$var19)+(0.3028*input$var16*input$var20)+(0.00438*input$var16*input$var21)+(-2.247*input$var17*input$var25)+(0.00192*input$var17*input$var18)+(0.03422*input$var17*input$var19)+(-0.0192*input$var17*input$var20)+(-0.0027*input$var17*input$var21)+(0.1246*input$var25*input$var18)+(0.02429*input$var25*input$var19)+(0.00157*input$var25*input$var20)+(-0.00145*input$var25*input$var21)+(-0.00037*input$var18*input$var19)+(0.00105*input$var18*input$var20)+(-0.00008*input$var18*input$var21)+(-0.00034*input$var19*input$var20)+(0.00007*input$var19*input$var21)+(-0.000002*input$var20*input$var21)
  x4<- ifelse(x4<0, 0, x4)
  #NHB_EID
  x5<-x1-(x3/(input$var22/12))
  #NHB_ScT
  x6<-x2-(x4/(input$var22/12))
  #Difference in NHB 
  x7=abs(x6-x5)
  y<-if(x7<=0.25){print("Similar economic value")} else if (x7>0.25 & x6>x5){print("EID and EPI")} else if (x7>0.25 & x5>x6){print("EID")}
  paste("The strategy with the greatest NHB is:", y)
})
output$selected_var25<-renderText({
  #LmsEID
  x1<-325.96898+(-65.64293*input$var1)+(0.85028*input$var2)+(-5.42326*input$var3)+(-4.15119*input$var4)+(2.91058*input$var5)+(0.10749*input$var6)+(-0.55402*input$var8)+(-0.36339*input$var10)+(-0.05702*input$var11)+(33.41571*input$var1*input$var2)+(24.59938*input$var1*input$var3)+(21.38804*input$var1*input$var4)+(-5.72805*input$var1*input$var5)+(-0.17202*input$var1*input$var6)+(1.99266*input$var1*input$var8)+(2.09233*input$var1*input$var10)+(-0.11179*input$var1*input$var11)+(-1.39281*input$var2*input$var3)+(-0.95314*input$var2*input$var4)+(-45.75619*input$var2*input$var5)+(-2.03017*input$var2*input$var6)+(-1.25262*input$var2*input$var8)+(0.40957*input$var2*input$var10)+(0.29101*input$var2*input$var11)+(8.47016*input$var3*input$var4)+(0.76250*input$var3*input$var5)+(0.03294*input$var3*input$var6)+(0.84607*input$var3*input$var8)+(0.76402*input$var3*input$var10)+(-0.04576*input$var3*input$var11)+(0.76045*input$var4*input$var5)+(0.02487*input$var4*input$var6)+(-0.53845*input$var4*input$var8)+(-0.70971*input$var4*input$var10)+(0.09412*input$var4*input$var11)+(-0.57044*input$var5*input$var6)+(0.13468*input$var5*input$var8)+(0.10450*input$var5*input$var10)+(0.05676*input$var5*input$var11)+(-0.00346*input$var6*input$var8)+(-0.00874*input$var6*input$var10)+(0.00164*input$var6*input$var11)+(0.78452*input$var8*input$var10)+(0.01209*input$var8*input$var11)+(-0.04867*input$var10*input$var11)
  x1<- ifelse(x1<0, 0, x1)
  #LmsScT
  x2<-325.8+(-66.64*input$var1)+(1.119*input$var2)+(-4*input$var3)+(-4.04*input$var4)+(2.71*input$var5)+(0.08868*input$var6)+(-0.56870*input$var7)+(-0.10810*input$var8)+(-0.5796*input$var10)+(0.00581*input$var11)+(-0.47840*input$var13)+(-0.05943*input$var16)+(0.07171*input$var17)+(-0.22370*input$var25)+(33.93*input$var1*input$var2)+(22.41*input$var1*input$var3)+(21.21*input$var1*input$var4)+(-5.528*input$var1*input$var5)+(-0.1625*input$var1*input$var6)+(2.969*input$var1*input$var7)+(1.319*input$var1*input$var8)+(2.644*input$var1*input$var10)+(-0.2068*input$var1*input$var11)+(2.863*input$var1*input$var13)+(2.344*input$var1*input$var16)+(-0.05278*input$var1*input$var17)+(-0.4096*input$var1*input$var25)+(-1.631*input$var2*input$var3)+(-0.1795*input$var2*input$var4)+(-44.87*input$var2*input$var5)+(-1.98*input$var2*input$var6)+(1.236*input$var2*input$var7)+(-1.756*input$var2*input$var8)+(0.41140*input$var2*input$var10)+(0.2513*input$var2*input$var11)+(0.3607*input$var2*input$var13)+(-2.627*input$var2*input$var16)+(-0.2477*input$var2*input$var17)+(-0.1358*input$var2*input$var25)+(8.177*input$var3*input$var4)+(0.6897*input$var3*input$var5)+(0.02711*input$var3*input$var6)+(-0.6196*input$var3*input$var7)+(0.598*input$var3*input$var8)+(0.9834*input$var3*input$var10)+(-0.07017*input$var3*input$var11)+(-0.7655*input$var3*input$var13)+(-1.122*input$var3*input$var16)+(0.06395*input$var3*input$var17)+(0.04591*input$var3*input$var25)+(0.9303*input$var4*input$var5)+(0.03151*input$var4*input$var6)+(-0.0914*input$var4*input$var7)+(-0.3743*input$var4*input$var8)+(-0.9214*input$var4*input$var10)+(0.0905*input$var4*input$var11)+(-0.0536*input$var4*input$var13)+(0.1172*input$var4*input$var16)+(-0.03714*input$var4*input$var17)+(-0.03*input$var4*input$var25)+(-0.559*input$var5*input$var6)+(0.08266*input$var5*input$var7)+(0.1511*input$var5*input$var8)+(0.0587*input$var5*input$var10)+(0.03836*input$var5*input$var11)+(0.1127*input$var5*input$var13)+(-0.1129*input$var5*input$var16)+(0.00048*input$var5*input$var17)+(0.1121*input$var5*input$var25)+(0.00778*input$var6*input$var7)+(-0.00449*input$var6*input$var8)+(-0.00756*input$var6*input$var10)+(0.00106*input$var6*input$var11)+(0.00659*input$var6*input$var13)+(0.00449*input$var6*input$var16)+(-0.00016*input$var6*input$var17)+(0.01242*input$var6*input$var25)+(-0.1936*input$var7*input$var8)+(0.2752*input$var7*input$var10)+(-0.0318*input$var7*input$var11)+(0.8034*input$var7*input$var13)+(0.5899*input$var7*input$var16)+(-0.04943*input$var7*input$var17)+(-0.0051*input$var7*input$var25)+(0.5247*input$var8*input$var10)+(0.0247*input$var8*input$var11)+(-0.1428*input$var8*input$var13)+(-0.05491*input$var8*input$var16)+(-0.05702*input$var8*input$var17)+(0.07405*input$var8*input$var25)+(-0.05598*input$var10*input$var11)+(0.2616*input$var10*input$var13)+(0.05041*input$var10*input$var16)+(0.00479*input$var10*input$var17)+(0.1204*input$var10*input$var25)+(-0.01216*input$var11*input$var13)+(0.00154*input$var11*input$var16)+(-0.00403*input$var11*input$var17)+(-0.00442*input$var11*input$var25)+(0.8933*input$var13*input$var16)+(-0.07485*input$var13*input$var17)+(0.1575*input$var13*input$var25)+(-0.03179*input$var16*input$var17)+(0.04996*input$var16*input$var25)+(0.01685*input$var17*input$var25)
  x2<- ifelse(x2<0, 0, x2)
  #CostEID
  x3<--19.03+(637*input$var1)+(-1620*input$var2)+(255.7*input$var3)+(361.4*input$var4)+(-365.1*input$var5)+(-15.39*input$var6)+(-31.63*input$var8)+(-31.76*input$var10)+(5.6870*input$var11)+(-0.5049*input$var18)+(-0.3282*input$var20)+(0.0026*input$var21)+(-1051*input$var1*input$var2)+(-613*input$var1*input$var3)+(-812.3*input$var1*input$var4)+(227.6*input$var1*input$var5)+(8.08*input$var1*input$var6)+(90.88*input$var1*input$var8)+(85.64*input$var1*input$var10)+(-9.555*input$var1*input$var11)+(11.51*input$var1*input$var18)+(8.226*input$var1*input$var20)+(0.5837*input$var1*input$var21)+(88.91*input$var2*input$var3)+(101.9*input$var2*input$var4)+(2187*input$var2*input$var5)+(108.1*input$var2*input$var6)+(130*input$var2*input$var8)+(0.3141*input$var2*input$var10)+(1.133*input$var2*input$var11)+(8.958*input$var2*input$var18)+(4.949*input$var2*input$var20)+(0.3584*input$var2*input$var21)+(-330.1*input$var3*input$var4)+(-30.67*input$var3*input$var5)+(-1.561*input$var3*input$var6)+(32.54*input$var3*input$var8)+(33.97*input$var3*input$var10)+(-2.339*input$var3*input$var11)+(-1.041*input$var3*input$var18)+(-0.6619*input$var3*input$var20)+(-0.0642*input$var3*input$var21)+(-45.63*input$var4*input$var5)+(-0.94*input$var4*input$var6)+(-30.41*input$var4*input$var8)+(-23.24*input$var4*input$var10)+(-0.5821*input$var4*input$var11)+(-1.538*input$var4*input$var18)+(-1.13*input$var4*input$var20)+(-0.08*input$var4*input$var21)+(30.13*input$var5*input$var6)+(3.4070*input$var5*input$var8)+(-7.77*input$var5*input$var10)+(-3.75*input$var5*input$var11)+(2.1840*input$var5*input$var18)+(1.512*input$var5*input$var20)+(0.1083*input$var5*input$var21)+(0.0687*input$var6*input$var8)+(0.3533*input$var6*input$var10)+(-0.06*input$var6*input$var11)+(0.1094*input$var6*input$var18)+(0.0669*input$var6*input$var20)+(0.0051*input$var6*input$var21)+(28.89*input$var8*input$var10)+(-3.36*input$var8*input$var11)+(0.2090*input$var8*input$var18)+(0.1571*input$var8*input$var20)+(0.0012*input$var8*input$var21)+(-1.325*input$var10*input$var11)+(0.1175*input$var10*input$var18)+(0.2198*input$var10*input$var20)+(-0.0006*input$var10*input$var21)+(-0.0151*input$var11*input$var18)+(-0.0049*input$var11*input$var20)+(0.0018*input$var11*input$var21)+(0.0004*input$var18*input$var20)+(-0.0001*input$var18*input$var21)+(0.000012*input$var20*input$var21)
  x3<- ifelse(x3<0, 0, x3)
  #CostScT
  x4<--29.88+(579.4*input$var1)+(-1674*input$var2)+(331.9*input$var3)+(378.4*input$var4)+(-364*input$var5)+(-14.94*input$var6)+(-13.95*input$var7)+(-2.058*input$var8)+(-33.24*input$var10)+(6.182*input$var11)+(-21.17*input$var13)+(-57.1*input$var16)+(4.165*input$var17)+(1.046*input$var25)+(-0.9352*input$var18)+(0.6128*input$var19)+(-0.43*input$var20)+(0.01005*input$var21)+(-1037*input$var1*input$var2)+(-727.8*input$var1*input$var3)+(-845.1*input$var1*input$var4)+(203*input$var1*input$var5)+(7.504*input$var1*input$var6)+(62.44*input$var1*input$var7)+(58.31*input$var1*input$var8)+(114.1*input$var1*input$var10)+(-11.44*input$var1*input$var11)+(154.1*input$var1*input$var13)+(131.2*input$var1*input$var16)+(-10.06*input$var1*input$var17)+(26.82*input$var1*input$var25)+(12.66*input$var1*input$var18)+(-0.6394*input$var1*input$var19)+(8.881*input$var1*input$var20)+(0.5835*input$var1*input$var21)+(71.44*input$var2*input$var3)+(124.3*input$var2*input$var4)+(2195*input$var2*input$var5)+(108.9*input$var2*input$var6)+(-99.21*input$var2*input$var7)+(118*input$var2*input$var8)+(10.57*input$var2*input$var10)+(-6.466*input$var2*input$var11)+(65.95*input$var2*input$var13)+(123.7*input$var2*input$var16)+(21.75*input$var2*input$var17)+(-34.83*input$var2*input$var25)+(9.704*input$var2*input$var18)+(-0.4924*input$var2*input$var19)+(4.977*input$var2*input$var20)+(0.3472*input$var2*input$var21)+(-337.7*input$var3*input$var4)+(-20.33*input$var3*input$var5)+(-1.373*input$var3*input$var6)+(-25.79*input$var3*input$var7)+(16.44*input$var3*input$var8)+(48.76*input$var3*input$var10)+(-3.573*input$var3*input$var11)+(-41.72*input$var3*input$var13)+(-44.9*input$var3*input$var16)+(2.63*input$var3*input$var17)+(4.244*input$var3*input$var25)+(-1.353*input$var3*input$var18)+(-0.3198*input$var3*input$var19)+(-0.8434*input$var3*input$var20)+(-0.06211*input$var3*input$var21)+(-51.83*input$var4*input$var5)+(-1.475*input$var4*input$var6)+(-5.269*input$var4*input$var7)+(-23.05*input$var4*input$var8)+(-34.26*input$var4*input$var10)+(-0.4346*input$var4*input$var11)+(-3.35*input$var4*input$var13)+(7.076*input$var4*input$var16)+(-1.532*input$var4*input$var17)+(5.414*input$var4*input$var25)+(-1.643*input$var4*input$var18)+(0.06333*input$var4*input$var19)+(-1.171*input$var4*input$var20)+(-0.08339*input$var4*input$var21)+(29.78*input$var5*input$var6)+(-0.41120*input$var5*input$var7)+(4.13*input$var5*input$var8)+(-10.09*input$var5*input$var10)+(-4.651*input$var5*input$var11)+(-10.88*input$var5*input$var13)+(11.99*input$var5*input$var16)+(1.403*input$var5*input$var17)+(-8.296*input$var5*input$var25)+(2.199*input$var5*input$var18)+(0.2933*input$var5*input$var19)+(1.458*input$var5*input$var20)+(0.1091*input$var5*input$var21)+(0.06694*input$var6*input$var7)+(0.1105*input$var6*input$var8)+(0.4299*input$var6*input$var10)+(-0.05114*input$var6*input$var11)+(-0.5719*input$var6*input$var13)+(0.1509*input$var6*input$var16)+(0.07651*input$var6*input$var17)+(-0.1703*input$var6*input$var25)+(0.106*input$var6*input$var18)+(0.00488*input$var6*input$var19)+(0.06639*input$var6*input$var20)+(0.00486*input$var6*input$var21)+(-4.566*input$var7*input$var8)+(8.398*input$var7*input$var10)+(4.795*input$var7*input$var11)+(37.95*input$var7*input$var13)+(30.77*input$var7*input$var16)+(-3.951*input$var7*input$var17)+(0.09802*input$var7*input$var25)+(0.2588*input$var7*input$var18)+(0.6513*input$var7*input$var19)+(0.09499*input$var7*input$var20)+(-0.00109*input$var7*input$var21)+(15.2*input$var8*input$var10)+(-2.298*input$var8*input$var11)+(-19.12*input$var8*input$var13)+(1.216*input$var8*input$var16)+(1.84*input$var8*input$var17)+(-5.223*input$var8*input$var25)+(0.1183*input$var8*input$var18)+(-0.1951*input$var8*input$var19)+(0.1031*input$var8*input$var20)+(0.00255*input$var8*input$var21)+(-0.9935*input$var10*input$var11)+(5.032*input$var10*input$var13)+(-0.09891*input$var10*input$var16)+(0.1592*input$var10*input$var17)+(-4.319*input$var10*input$var25)+(0.20420*input$var10*input$var18)+(-0.04898*input$var10*input$var19)+(0.2718*input$var10*input$var20)+(-0.00432*input$var10*input$var21)+(-2.491*input$var11*input$var13)+(-0.6542*input$var11*input$var16)+(0.3382*input$var11*input$var17)+(0.4483*input$var11*input$var25)+(-0.02123*input$var11*input$var18)+(-0.06059*input$var11*input$var19)+(-0.01211*input$var11*input$var20)+(0.00209*input$var11*input$var21)+(54.36*input$var13*input$var16)+(-0.04295*input$var13*input$var17)+(-5.744*input$var13*input$var25)+(0.4111*input$var13*input$var18)+(-0.06323*input$var13*input$var19)+(0.1698*input$var13*input$var20)+(-0.00222*input$var13*input$var21)+(-6.228*input$var16*input$var17)+(0.5095*input$var16*input$var25)+(0.4626*input$var16*input$var18)+(-0.03676*input$var16*input$var19)+(0.3028*input$var16*input$var20)+(0.00438*input$var16*input$var21)+(-2.247*input$var17*input$var25)+(0.00192*input$var17*input$var18)+(0.03422*input$var17*input$var19)+(-0.0192*input$var17*input$var20)+(-0.0027*input$var17*input$var21)+(0.1246*input$var25*input$var18)+(0.02429*input$var25*input$var19)+(0.00157*input$var25*input$var20)+(-0.00145*input$var25*input$var21)+(-0.00037*input$var18*input$var19)+(0.00105*input$var18*input$var20)+(-0.00008*input$var18*input$var21)+(-0.00034*input$var19*input$var20)+(0.00007*input$var19*input$var21)+(-0.000002*input$var20*input$var21)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
  x4<- ifelse(x4<0, 0, x4)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
  #NHB_EID
  x5<-x1-(x3/(input$var22/12))
  x9<-(x5/12)
  paste("NHB of EID =",round(x5,digits=4),"life-months or",round(x9,digits=4),"life-years")
})
  output$selected_var26<-renderText({
  #LmsEID
  x1<-325.96898+(-65.64293*input$var1)+(0.85028*input$var2)+(-5.42326*input$var3)+(-4.15119*input$var4)+(2.91058*input$var5)+(0.10749*input$var6)+(-0.55402*input$var8)+(-0.36339*input$var10)+(-0.05702*input$var11)+(33.41571*input$var1*input$var2)+(24.59938*input$var1*input$var3)+(21.38804*input$var1*input$var4)+(-5.72805*input$var1*input$var5)+(-0.17202*input$var1*input$var6)+(1.99266*input$var1*input$var8)+(2.09233*input$var1*input$var10)+(-0.11179*input$var1*input$var11)+(-1.39281*input$var2*input$var3)+(-0.95314*input$var2*input$var4)+(-45.75619*input$var2*input$var5)+(-2.03017*input$var2*input$var6)+(-1.25262*input$var2*input$var8)+(0.40957*input$var2*input$var10)+(0.29101*input$var2*input$var11)+(8.47016*input$var3*input$var4)+(0.76250*input$var3*input$var5)+(0.03294*input$var3*input$var6)+(0.84607*input$var3*input$var8)+(0.76402*input$var3*input$var10)+(-0.04576*input$var3*input$var11)+(0.76045*input$var4*input$var5)+(0.02487*input$var4*input$var6)+(-0.53845*input$var4*input$var8)+(-0.70971*input$var4*input$var10)+(0.09412*input$var4*input$var11)+(-0.57044*input$var5*input$var6)+(0.13468*input$var5*input$var8)+(0.10450*input$var5*input$var10)+(0.05676*input$var5*input$var11)+(-0.00346*input$var6*input$var8)+(-0.00874*input$var6*input$var10)+(0.00164*input$var6*input$var11)+(0.78452*input$var8*input$var10)+(0.01209*input$var8*input$var11)+(-0.04867*input$var10*input$var11)
  x1<- ifelse(x1<0, 0, x1)
  #LmsScT
  x2<-325.8+(-66.64*input$var1)+(1.119*input$var2)+(-4*input$var3)+(-4.04*input$var4)+(2.71*input$var5)+(0.08868*input$var6)+(-0.56870*input$var7)+(-0.10810*input$var8)+(-0.5796*input$var10)+(0.00581*input$var11)+(-0.47840*input$var13)+(-0.05943*input$var16)+(0.07171*input$var17)+(-0.22370*input$var25)+(33.93*input$var1*input$var2)+(22.41*input$var1*input$var3)+(21.21*input$var1*input$var4)+(-5.528*input$var1*input$var5)+(-0.1625*input$var1*input$var6)+(2.969*input$var1*input$var7)+(1.319*input$var1*input$var8)+(2.644*input$var1*input$var10)+(-0.2068*input$var1*input$var11)+(2.863*input$var1*input$var13)+(2.344*input$var1*input$var16)+(-0.05278*input$var1*input$var17)+(-0.4096*input$var1*input$var25)+(-1.631*input$var2*input$var3)+(-0.1795*input$var2*input$var4)+(-44.87*input$var2*input$var5)+(-1.98*input$var2*input$var6)+(1.236*input$var2*input$var7)+(-1.756*input$var2*input$var8)+(0.41140*input$var2*input$var10)+(0.2513*input$var2*input$var11)+(0.3607*input$var2*input$var13)+(-2.627*input$var2*input$var16)+(-0.2477*input$var2*input$var17)+(-0.1358*input$var2*input$var25)+(8.177*input$var3*input$var4)+(0.6897*input$var3*input$var5)+(0.02711*input$var3*input$var6)+(-0.6196*input$var3*input$var7)+(0.598*input$var3*input$var8)+(0.9834*input$var3*input$var10)+(-0.07017*input$var3*input$var11)+(-0.7655*input$var3*input$var13)+(-1.122*input$var3*input$var16)+(0.06395*input$var3*input$var17)+(0.04591*input$var3*input$var25)+(0.9303*input$var4*input$var5)+(0.03151*input$var4*input$var6)+(-0.0914*input$var4*input$var7)+(-0.3743*input$var4*input$var8)+(-0.9214*input$var4*input$var10)+(0.0905*input$var4*input$var11)+(-0.0536*input$var4*input$var13)+(0.1172*input$var4*input$var16)+(-0.03714*input$var4*input$var17)+(-0.03*input$var4*input$var25)+(-0.559*input$var5*input$var6)+(0.08266*input$var5*input$var7)+(0.1511*input$var5*input$var8)+(0.0587*input$var5*input$var10)+(0.03836*input$var5*input$var11)+(0.1127*input$var5*input$var13)+(-0.1129*input$var5*input$var16)+(0.00048*input$var5*input$var17)+(0.1121*input$var5*input$var25)+(0.00778*input$var6*input$var7)+(-0.00449*input$var6*input$var8)+(-0.00756*input$var6*input$var10)+(0.00106*input$var6*input$var11)+(0.00659*input$var6*input$var13)+(0.00449*input$var6*input$var16)+(-0.00016*input$var6*input$var17)+(0.01242*input$var6*input$var25)+(-0.1936*input$var7*input$var8)+(0.2752*input$var7*input$var10)+(-0.0318*input$var7*input$var11)+(0.8034*input$var7*input$var13)+(0.5899*input$var7*input$var16)+(-0.04943*input$var7*input$var17)+(-0.0051*input$var7*input$var25)+(0.5247*input$var8*input$var10)+(0.0247*input$var8*input$var11)+(-0.1428*input$var8*input$var13)+(-0.05491*input$var8*input$var16)+(-0.05702*input$var8*input$var17)+(0.07405*input$var8*input$var25)+(-0.05598*input$var10*input$var11)+(0.2616*input$var10*input$var13)+(0.05041*input$var10*input$var16)+(0.00479*input$var10*input$var17)+(0.1204*input$var10*input$var25)+(-0.01216*input$var11*input$var13)+(0.00154*input$var11*input$var16)+(-0.00403*input$var11*input$var17)+(-0.00442*input$var11*input$var25)+(0.8933*input$var13*input$var16)+(-0.07485*input$var13*input$var17)+(0.1575*input$var13*input$var25)+(-0.03179*input$var16*input$var17)+(0.04996*input$var16*input$var25)+(0.01685*input$var17*input$var25)
  x2<- ifelse(x2<0, 0, x2)
  #CostEID
  x3<--19.03+(637*input$var1)+(-1620*input$var2)+(255.7*input$var3)+(361.4*input$var4)+(-365.1*input$var5)+(-15.39*input$var6)+(-31.63*input$var8)+(-31.76*input$var10)+(5.6870*input$var11)+(-0.5049*input$var18)+(-0.3282*input$var20)+(0.0026*input$var21)+(-1051*input$var1*input$var2)+(-613*input$var1*input$var3)+(-812.3*input$var1*input$var4)+(227.6*input$var1*input$var5)+(8.08*input$var1*input$var6)+(90.88*input$var1*input$var8)+(85.64*input$var1*input$var10)+(-9.555*input$var1*input$var11)+(11.51*input$var1*input$var18)+(8.226*input$var1*input$var20)+(0.5837*input$var1*input$var21)+(88.91*input$var2*input$var3)+(101.9*input$var2*input$var4)+(2187*input$var2*input$var5)+(108.1*input$var2*input$var6)+(130*input$var2*input$var8)+(0.3141*input$var2*input$var10)+(1.133*input$var2*input$var11)+(8.958*input$var2*input$var18)+(4.949*input$var2*input$var20)+(0.3584*input$var2*input$var21)+(-330.1*input$var3*input$var4)+(-30.67*input$var3*input$var5)+(-1.561*input$var3*input$var6)+(32.54*input$var3*input$var8)+(33.97*input$var3*input$var10)+(-2.339*input$var3*input$var11)+(-1.041*input$var3*input$var18)+(-0.6619*input$var3*input$var20)+(-0.0642*input$var3*input$var21)+(-45.63*input$var4*input$var5)+(-0.94*input$var4*input$var6)+(-30.41*input$var4*input$var8)+(-23.24*input$var4*input$var10)+(-0.5821*input$var4*input$var11)+(-1.538*input$var4*input$var18)+(-1.13*input$var4*input$var20)+(-0.08*input$var4*input$var21)+(30.13*input$var5*input$var6)+(3.4070*input$var5*input$var8)+(-7.77*input$var5*input$var10)+(-3.75*input$var5*input$var11)+(2.1840*input$var5*input$var18)+(1.512*input$var5*input$var20)+(0.1083*input$var5*input$var21)+(0.0687*input$var6*input$var8)+(0.3533*input$var6*input$var10)+(-0.06*input$var6*input$var11)+(0.1094*input$var6*input$var18)+(0.0669*input$var6*input$var20)+(0.0051*input$var6*input$var21)+(28.89*input$var8*input$var10)+(-3.36*input$var8*input$var11)+(0.2090*input$var8*input$var18)+(0.1571*input$var8*input$var20)+(0.0012*input$var8*input$var21)+(-1.325*input$var10*input$var11)+(0.1175*input$var10*input$var18)+(0.2198*input$var10*input$var20)+(-0.0006*input$var10*input$var21)+(-0.0151*input$var11*input$var18)+(-0.0049*input$var11*input$var20)+(0.0018*input$var11*input$var21)+(0.0004*input$var18*input$var20)+(-0.0001*input$var18*input$var21)+(0.000012*input$var20*input$var21)
  x3<- ifelse(x3<0, 0, x3)
  #CostScT
  x4<--29.88+(579.4*input$var1)+(-1674*input$var2)+(331.9*input$var3)+(378.4*input$var4)+(-364*input$var5)+(-14.94*input$var6)+(-13.95*input$var7)+(-2.058*input$var8)+(-33.24*input$var10)+(6.182*input$var11)+(-21.17*input$var13)+(-57.1*input$var16)+(4.165*input$var17)+(1.046*input$var25)+(-0.9352*input$var18)+(0.6128*input$var19)+(-0.43*input$var20)+(0.01005*input$var21)+(-1037*input$var1*input$var2)+(-727.8*input$var1*input$var3)+(-845.1*input$var1*input$var4)+(203*input$var1*input$var5)+(7.504*input$var1*input$var6)+(62.44*input$var1*input$var7)+(58.31*input$var1*input$var8)+(114.1*input$var1*input$var10)+(-11.44*input$var1*input$var11)+(154.1*input$var1*input$var13)+(131.2*input$var1*input$var16)+(-10.06*input$var1*input$var17)+(26.82*input$var1*input$var25)+(12.66*input$var1*input$var18)+(-0.6394*input$var1*input$var19)+(8.881*input$var1*input$var20)+(0.5835*input$var1*input$var21)+(71.44*input$var2*input$var3)+(124.3*input$var2*input$var4)+(2195*input$var2*input$var5)+(108.9*input$var2*input$var6)+(-99.21*input$var2*input$var7)+(118*input$var2*input$var8)+(10.57*input$var2*input$var10)+(-6.466*input$var2*input$var11)+(65.95*input$var2*input$var13)+(123.7*input$var2*input$var16)+(21.75*input$var2*input$var17)+(-34.83*input$var2*input$var25)+(9.704*input$var2*input$var18)+(-0.4924*input$var2*input$var19)+(4.977*input$var2*input$var20)+(0.3472*input$var2*input$var21)+(-337.7*input$var3*input$var4)+(-20.33*input$var3*input$var5)+(-1.373*input$var3*input$var6)+(-25.79*input$var3*input$var7)+(16.44*input$var3*input$var8)+(48.76*input$var3*input$var10)+(-3.573*input$var3*input$var11)+(-41.72*input$var3*input$var13)+(-44.9*input$var3*input$var16)+(2.63*input$var3*input$var17)+(4.244*input$var3*input$var25)+(-1.353*input$var3*input$var18)+(-0.3198*input$var3*input$var19)+(-0.8434*input$var3*input$var20)+(-0.06211*input$var3*input$var21)+(-51.83*input$var4*input$var5)+(-1.475*input$var4*input$var6)+(-5.269*input$var4*input$var7)+(-23.05*input$var4*input$var8)+(-34.26*input$var4*input$var10)+(-0.4346*input$var4*input$var11)+(-3.35*input$var4*input$var13)+(7.076*input$var4*input$var16)+(-1.532*input$var4*input$var17)+(5.414*input$var4*input$var25)+(-1.643*input$var4*input$var18)+(0.06333*input$var4*input$var19)+(-1.171*input$var4*input$var20)+(-0.08339*input$var4*input$var21)+(29.78*input$var5*input$var6)+(-0.41120*input$var5*input$var7)+(4.13*input$var5*input$var8)+(-10.09*input$var5*input$var10)+(-4.651*input$var5*input$var11)+(-10.88*input$var5*input$var13)+(11.99*input$var5*input$var16)+(1.403*input$var5*input$var17)+(-8.296*input$var5*input$var25)+(2.199*input$var5*input$var18)+(0.2933*input$var5*input$var19)+(1.458*input$var5*input$var20)+(0.1091*input$var5*input$var21)+(0.06694*input$var6*input$var7)+(0.1105*input$var6*input$var8)+(0.4299*input$var6*input$var10)+(-0.05114*input$var6*input$var11)+(-0.5719*input$var6*input$var13)+(0.1509*input$var6*input$var16)+(0.07651*input$var6*input$var17)+(-0.1703*input$var6*input$var25)+(0.106*input$var6*input$var18)+(0.00488*input$var6*input$var19)+(0.06639*input$var6*input$var20)+(0.00486*input$var6*input$var21)+(-4.566*input$var7*input$var8)+(8.398*input$var7*input$var10)+(4.795*input$var7*input$var11)+(37.95*input$var7*input$var13)+(30.77*input$var7*input$var16)+(-3.951*input$var7*input$var17)+(0.09802*input$var7*input$var25)+(0.2588*input$var7*input$var18)+(0.6513*input$var7*input$var19)+(0.09499*input$var7*input$var20)+(-0.00109*input$var7*input$var21)+(15.2*input$var8*input$var10)+(-2.298*input$var8*input$var11)+(-19.12*input$var8*input$var13)+(1.216*input$var8*input$var16)+(1.84*input$var8*input$var17)+(-5.223*input$var8*input$var25)+(0.1183*input$var8*input$var18)+(-0.1951*input$var8*input$var19)+(0.1031*input$var8*input$var20)+(0.00255*input$var8*input$var21)+(-0.9935*input$var10*input$var11)+(5.032*input$var10*input$var13)+(-0.09891*input$var10*input$var16)+(0.1592*input$var10*input$var17)+(-4.319*input$var10*input$var25)+(0.20420*input$var10*input$var18)+(-0.04898*input$var10*input$var19)+(0.2718*input$var10*input$var20)+(-0.00432*input$var10*input$var21)+(-2.491*input$var11*input$var13)+(-0.6542*input$var11*input$var16)+(0.3382*input$var11*input$var17)+(0.4483*input$var11*input$var25)+(-0.02123*input$var11*input$var18)+(-0.06059*input$var11*input$var19)+(-0.01211*input$var11*input$var20)+(0.00209*input$var11*input$var21)+(54.36*input$var13*input$var16)+(-0.04295*input$var13*input$var17)+(-5.744*input$var13*input$var25)+(0.4111*input$var13*input$var18)+(-0.06323*input$var13*input$var19)+(0.1698*input$var13*input$var20)+(-0.00222*input$var13*input$var21)+(-6.228*input$var16*input$var17)+(0.5095*input$var16*input$var25)+(0.4626*input$var16*input$var18)+(-0.03676*input$var16*input$var19)+(0.3028*input$var16*input$var20)+(0.00438*input$var16*input$var21)+(-2.247*input$var17*input$var25)+(0.00192*input$var17*input$var18)+(0.03422*input$var17*input$var19)+(-0.0192*input$var17*input$var20)+(-0.0027*input$var17*input$var21)+(0.1246*input$var25*input$var18)+(0.02429*input$var25*input$var19)+(0.00157*input$var25*input$var20)+(-0.00145*input$var25*input$var21)+(-0.00037*input$var18*input$var19)+(0.00105*input$var18*input$var20)+(-0.00008*input$var18*input$var21)+(-0.00034*input$var19*input$var20)+(0.00007*input$var19*input$var21)+(-0.000002*input$var20*input$var21)
  x4<- ifelse(x4<0, 0, x4)
  #NHB_ScT
  x6<-x2-(x4/(input$var22/12))
  x8<-(x6/12)
  paste("NHB of EID and EPI =",round(x6,digits=4),"life-months or",round(x8,digits=4),"life-years")
})
output$selected_var7<-renderText({
  paste("Note: If the difference in NHB between the strategies is smaller than 0.25 life-months (~8 days), the difference represents too narrow a margin to make a decision, which is indicated by: “Similar economic value”")
})
output$selected_var8<-renderText({
  x1<-(180.7844+(-54.808*input$var1)+(108.3001*input$var2)+(18.2457*input$var3)+(-6.3086*input$var4)+(-9.2666*input$var5)+(0.9144*input$var6)+(17.1434*input$var8)+(14.6359*input$var10)+(-1.6104*input$var11)+(11.1069*input$var3*input$var4)+(4.2319*input$var5*input$var6))/12
  x1<- ifelse(x1<0, 0, x1)
  x2<-(182.8576+(-43.6242*input$var1)+(89.2738*input$var2)+(11.4238*input$var3)+(-3.9758*input$var4)+(-9.8434*input$var5)+(0.6747*input$var6)+(18.3575*input$var7)+(9.2331*input$var8)+(20.2067*input$var10)+(-1.8734*input$var11)+(23.129*input$var13)+(22.3103*input$var16)+(-2.3398*input$var17)+(-11.871*input$var25)+(9.2933*input$var3*input$var4)+(3.5726*input$var5*input$var6))/12
  x2<- ifelse(x2<0, 0, x2)
  paste("- Life expectancy (discounted): Mean improvement of",round(x2-x1,digits=2),"years")
})
output$selected_var9<-renderText({
  x1<-(180.7844+(-54.808*input$var1)+(108.3001*input$var2)+(18.2457*input$var3)+(-6.3086*input$var4)+(-9.2666*input$var5)+(0.9144*input$var6)+(17.1434*input$var8)+(14.6359*input$var10)+(-1.6104*input$var11)+(11.1069*input$var3*input$var4)+(4.2319*input$var5*input$var6))/12
  x1<- ifelse(x1<0, 0, x1)
  x2<-(182.8576+(-43.6242*input$var1)+(89.2738*input$var2)+(11.4238*input$var3)+(-3.9758*input$var4)+(-9.8434*input$var5)+(0.6747*input$var6)+(18.3575*input$var7)+(9.2331*input$var8)+(20.2067*input$var10)+(-1.8734*input$var11)+(23.129*input$var13)+(22.3103*input$var16)+(-2.3398*input$var17)+(-11.871*input$var25)+(9.2933*input$var3*input$var4)+(3.5726*input$var5*input$var6))/12
  x2<- ifelse(x2<0, 0, x2)
  paste("- Lifetime HIV-related costs (discounted): Mean increase of",round(x2-x1,digits=2),"US$")
})
output$plot1 <- renderPlot({
  # Life expectancy of HIV+ EID
  x1<-(103.55112+(18.89518*input$var1)+(5.69347*input$var2)+(-5.17427*input$var3)+(-0.95222*input$var4)+(2.42947*input$var5)+(0.78053*input$var6)+(0.21538*input$var8)+(-1.84537*input$var10)+(1.05578*input$var11)+(-212.25509*input$var1*input$var2)+(2.90019*input$var1*input$var3)+(-6.9106*input$var1*input$var4)+(-31.79417*input$var1*input$var5)+(-4.07133*input$var1*input$var6)+(8.59473*input$var1*input$var8)+(12.80056*input$var1*input$var10)+(-0.07257*input$var1*input$var11)+(-2.68022*input$var2*input$var3)+(18.49384*input$var2*input$var4)+(73.22695*input$var2*input$var5)+(7.98618*input$var2*input$var6)+(-15.21883*input$var2*input$var8)+(-17.10133*input$var2*input$var10)+(3.24426*input$var2*input$var11)+(3.51554*input$var3*input$var4)+(-3.96379*input$var3*input$var5)+(0.10737*input$var3*input$var6)+(19.8484*input$var3*input$var8)+(21.51864*input$var3*input$var10)+(-1.9527*input$var3*input$var11)+(4.36481*input$var4*input$var5)+(0.48971*input$var4*input$var6)+(-9.579*input$var4*input$var8)+(-7.20213*input$var4*input$var10)+(0.61172*input$var4*input$var11)+(2.50878*input$var5*input$var6)+(-5.43117*input$var5*input$var8)+(-5.71404*input$var5*input$var10)+(0.32699*input$var5*input$var11)+(-0.25604*input$var6*input$var8)+(-0.27759*input$var6*input$var10)+(0.02947*input$var6*input$var11)+(17.02486*input$var8*input$var10)+(-1.2754*input$var8*input$var11)+(-1.58885*input$var10*input$var11))/12
  x1<- ifelse(x1<0, 0, x1)
  # Life expectancy of HIV+ ScT
  x2<-(93.91265+(6.4629*input$var1)+(42.96596*input$var2)+(4.13937*input$var3)+(-2.06569*input$var4)+(10.52131*input$var5)+(1.11319*input$var6)+(-0.55176*input$var7)+(5.78487*input$var8)+(0.1614*input$var10)+(1.60121*input$var11)+(6.3736*input$var13)+(5.00768*input$var16)+(1.19656*input$var17)+(1.1679*input$var25)+(-182.64659*input$var1*input$var2)+(0.63421*input$var1*input$var3)+(-4.66249*input$var1*input$var4)+(-27.06059*input$var1*input$var5)+(-3.45872*input$var1*input$var6)+(7.88848*input$var1*input$var7)+(5.55663*input$var1*input$var8)+(16.64055*input$var1*input$var10)+(-0.32348*input$var1*input$var11)+(9.69546*input$var1*input$var13)+(7.74224*input$var1*input$var16)+(-1.00478*input$var1*input$var17)+(-1.11542*input$var1*input$var25)+(-6.12316*input$var2*input$var3)+(13.66839*input$var2*input$var4)+(51.97434*input$var2*input$var5)+(7.11782*input$var2*input$var6)+(-22.29521*input$var2*input$var7)+(-15.73987*input$var2*input$var8)+(-23.39634*input$var2*input$var10)+(0.8723*input$var2*input$var11)+(-25.64835*input$var2*input$var13)+(-19.24065*input$var2*input$var16)+(1.29382*input$var2*input$var17)+(2.15349*input$var2*input$var25)+(3.77628*input$var3*input$var4)+(-1.29836*input$var3*input$var5)+(0.15184*input$var3*input$var6)+(-4.32122*input$var3*input$var7)+(13.41489*input$var3*input$var8)+(28.00259*input$var3*input$var10)+(-2.32152*input$var3*input$var11)+(-10.37833*input$var3*input$var13)+(-17.3604*input$var3*input$var16)+(0.97891*input$var3*input$var17)+(-0.3967*input$var3*input$var25)+(2.73848*input$var4*input$var5)+(0.33725*input$var4*input$var6)+(0.87948*input$var4*input$var7)+(-6.92886*input$var4*input$var8)+(-10.78241*input$var4*input$var10)+(0.41584*input$var4*input$var11)+(3.02632*input$var4*input$var13)+(6.73991*input$var4*input$var16)+(-0.44437*input$var4*input$var17)+(0.20556*input$var4*input$var25)+(2.16755*input$var5*input$var6)+(-6.84868*input$var5*input$var7)+(-4.14694*input$var5*input$var8)+(-7.32246*input$var5*input$var10)+(0.47423*input$var5*input$var11)+(-7.2766*input$var5*input$var13)+(-4.71288*input$var5*input$var16)+(0.53135*input$var5*input$var17)+(-1.32287*input$var5*input$var25)+(-0.28767*input$var6*input$var7)+(-0.16157*input$var6*input$var8)+(-0.33254*input$var6*input$var10)+(0.02295*input$var6*input$var11)+(-0.39816*input$var6*input$var13)+(-0.29441*input$var6*input$var16)+(0.02321*input$var6*input$var17)+(-0.01629*input$var6*input$var25)+(-3.97431*input$var7*input$var8)+(5.61466*input$var7*input$var10)+(0.28868*input$var7*input$var11)+(17.91655*input$var7*input$var13)+(14.88227*input$var7*input$var16)+(-0.81459*input$var7*input$var17)+(0.21683*input$var7*input$var25)+(11.21629*input$var8*input$var10)+(-0.81844*input$var8*input$var11)+(-4.68093*input$var8*input$var13)+(-0.83926*input$var8*input$var16)+(-0.31374*input$var8*input$var17)+(0.74971*input$var8*input$var25)+(-1.77725*input$var10*input$var11)+(4.04567*input$var10*input$var13)+(0.22659*input$var10*input$var16)+(-0.4628*input$var10*input$var17)+(-2.18263*input$var10*input$var25)+(-0.59154*input$var11*input$var13)+(-0.64929*input$var11*input$var16)+(0.04537*input$var11*input$var17)+(-0.2328*input$var11*input$var25)+(21.61058*input$var13*input$var16)+(-1.51066*input$var13*input$var17)+(-0.43308*input$var13*input$var25)+(-1.81288*input$var16*input$var17)+(2.24701*input$var16*input$var25)+(-0.19267*input$var17*input$var25))/12
  x2<- ifelse(x2<0, 0, x2)
  labs=c("EID and EPI","EID")
  x<-barplot(matrix(c(x1,x2)), ylab="Life years", xlab="Strategy",col=c("#75AADB","firebrick3"),border='white', main="Fig. 5: Life expectancy in infants with HIV",names.arg = c("",""),cex.names=1.2,beside=TRUE,font=2,col.axis="#75AADB",yaxt="n")
  axiscolors=c("firebrick3","#75AADB")
  Map(function(x,y,z)
    axis(1,at=x,col.axis=y,labels=z,lwd=0,font=2),
    2.5:1.5,
    axiscolors,
    labs)
  axis(1,at=1:2,labels=FALSE,lwd=0)
  axis(side=2)
  text(x,0,pos=3,col="white",font=2,cex=1.2,labels=round(c(x1,x2),digits=2))
})
output$plot2 <- renderPlot({
  # Number of HIV-related deaths EID
  x3<-(-155500+(3861000*input$var1)+(-220700*input$var2)+(337600*input$var3)+(233400*input$var4)+(-36930*input$var5)+(-2243*input$var6)+(42680*input$var8)+(40770*input$var10)+(-167.2*input$var11)+(-572000*input$var1*input$var2)+(-1632000*input$var1*input$var3)+(-1342000*input$var1*input$var4)+(230600*input$var1*input$var5)+(3804*input$var1*input$var6)+(-181900*input$var1*input$var8)+(-190500*input$var1*input$var10)+(15180*input$var1*input$var11)+(116200*input$var2*input$var3)+(50730*input$var2*input$var4)+(1489000*input$var2*input$var5)+(41970*input$var2*input$var6)+(7334*input$var2*input$var8)+(-61980*input$var2*input$var10)+(-29500*input$var2*input$var11)+(-529900*input$var3*input$var4)+(-30840*input$var3*input$var5)+(-1107*input$var3*input$var6)+(-73370*input$var3*input$var8)+(-71180*input$var3*input$var10)+(7468*input$var3*input$var11)+(-21720*input$var4*input$var5)+(-480.3*input$var4*input$var6)+(52090*input$var4*input$var8)+(58190*input$var4*input$var10)+(-9329*input$var4*input$var11)+(11880*input$var5*input$var6)+(-2364*input$var5*input$var8)+(-10010*input$var5*input$var10)+(-3641*input$var5*input$var11)+(239*input$var6*input$var8)+(234.7*input$var6*input$var10)+(-87.06*input$var6*input$var11)+(-69150*input$var8*input$var10)+(3284*input$var8*input$var11)+(4920*input$var10*input$var11))/300
  x3<- ifelse(x3<0, 0, x3)
  # Number of HIV-related deaths ScT
  x4<-(-118500+(3904000*input$var1)+(-242200*input$var2)+(224300*input$var3)+(216500*input$var4)+(-29660*input$var5)+(-1710*input$var6)+(41160*input$var7)+(6664*input$var8)+(42890*input$var10)+(-5789*input$var11)+(26910*input$var13)+(2137*input$var16)+(-13080*input$var17)+(6623*input$var25)+(-582900*input$var1*input$var2)+(-1441000*input$var1*input$var3)+(-1316000*input$var1*input$var4)+(233000*input$var1*input$var5)+(3526*input$var1*input$var6)+(-231600*input$var1*input$var7)+(-126100*input$var1*input$var8)+(-236300*input$var1*input$var10)+(24690*input$var1*input$var11)+(-238200*input$var1*input$var13)+(-205700*input$var1*input$var16)+(13510*input$var1*input$var17)+(21950*input$var1*input$var25)+(143700*input$var2*input$var3)+(-9283*input$var2*input$var4)+(1434000*input$var2*input$var5)+(40030*input$var2*input$var6)+(-69020*input$var2*input$var7)+(51120*input$var2*input$var8)+(-63390*input$var2*input$var10)+(-21820*input$var2*input$var11)+(-34900*input$var2*input$var13)+(132200*input$var2*input$var16)+(6630*input$var2*input$var17)+(4667*input$var2*input$var25)+(-508800*input$var3*input$var4)+(-32800*input$var3*input$var5)+(-847.9*input$var3*input$var6)+(50870*input$var3*input$var7)+(-51860*input$var3*input$var8)+(-89490*input$var3*input$var10)+(10040*input$var3*input$var11)+(68570*input$var3*input$var13)+(99150*input$var3*input$var16)+(-8262*input$var3*input$var17)+(-5396*input$var3*input$var25)+(-27520*input$var4*input$var5)+(-508.5*input$var4*input$var6)+(7870*input$var4*input$var7)+(38050*input$var4*input$var8)+(76600*input$var4*input$var10)+(-9656*input$var4*input$var11)+(7098*input$var4*input$var13)+(-11370*input$var4*input$var16)+(3775*input$var4*input$var17)+(4447*input$var4*input$var25)+(11560*input$var5*input$var6)+(-3525*input$var5*input$var7)+(-3066*input$var5*input$var8)+(-5191*input$var5*input$var10)+(-1889*input$var5*input$var11)+(-11340*input$var5*input$var13)+(3710*input$var5*input$var16)+(67.69*input$var5*input$var17)+(-1720*input$var5*input$var25)+(-373.1*input$var6*input$var7)+(327.7*input$var6*input$var8)+(126*input$var6*input$var10)+(-31.69*input$var6*input$var11)+(-101.1*input$var6*input$var13)+(-270.1*input$var6*input$var16)+(39.76*input$var6*input$var17)+(-552.5*input$var6*input$var25)+(12380*input$var7*input$var8)+(-18300*input$var7*input$var10)+(908.5*input$var7*input$var11)+(-71820*input$var7*input$var13)+(-58020*input$var7*input$var16)+(5753*input$var7*input$var17)+(-504*input$var7*input$var25)+(-46730*input$var8*input$var10)+(1095*input$var8*input$var11)+(11910*input$var8*input$var13)+(5796*input$var8*input$var16)+(4480*input$var8*input$var17)+(-3275*input$var8*input$var25)+(6020*input$var10*input$var11)+(-16570*input$var10*input$var13)+(-4129*input$var10*input$var16)+(2449*input$var10*input$var17)+(-654.5*input$var10*input$var25)+(2504*input$var11*input$var13)+(1616*input$var11*input$var16)+(434.1*input$var11*input$var17)+(-280.8*input$var11*input$var25)+(-84390*input$var13*input$var16)+(9837*input$var13*input$var17)+(-8290*input$var13*input$var25)+(9273*input$var16*input$var17)+(-2966*input$var16*input$var25)+(153*input$var17*input$var25))/300
  x4<- ifelse(x4<0, 0, x4)
  labs=c("EID and EPI","EID")
  x<-barplot(matrix(c(x3,x4)), ylab="Deaths/100,000 births", xlab="Strategy",col=c('#75AADB',"firebrick3"),border='white',main="Fig. 4: HIV-related deaths by one year",names.arg = c("",""),beside=TRUE,yaxt="n",col.axis="#75AADB",cex.names=1.2)
  axiscolors=c("firebrick3","#75AADB")
  Map(function(x,y,z)
    axis(1,at=x,col.axis=y,labels=z,lwd=0,font=2),
    2.5:1.5,
    axiscolors,
    labs)
  axis(1,at=1:2,labels=FALSE,lwd=0)
  axis(side=2)
  text(x,0,pos=3,col="white",font=2,cex=1.2,paste(labels=round(c(x3,x4),digits=0)))
})
output$plot10 <- renderPlot({
  # True positives EID
  x1<-(15270.4+(-334878.71*input$var1)+(-192881.33*input$var2)+(-126190.67*input$var3)+(323434.89*input$var4)+(-2775.95*input$var5)+(-230.83*input$var6)+(-130704.82*input$var8)+(-125659.45*input$var10)+(6325.04*input$var11)+(13440.66*input$var1*input$var2)+(661110.91*input$var1*input$var3)+(-589432.99*input$var1*input$var4)+(51753.78*input$var1*input$var5)+(-119.08*input$var1*input$var6)+(627615.44*input$var1*input$var8)+(657164.02*input$var1*input$var10)+(-19863.29*input$var1*input$var11)+(133310.71*input$var2*input$var3)+(53295.85*input$var2*input$var4)+(-175559.47*input$var2*input$var5)+(480.93*input$var2*input$var6)+(63427.72*input$var2*input$var8)+(72710.15*input$var2*input$var10)+(41938.50*input$var2*input$var11)+(-233500.26*input$var3*input$var4)+(5864.09*input$var3*input$var5)+(123.64*input$var3*input$var6)+(243883.19*input$var3*input$var8)+(256487.16*input$var3*input$var10)+(-11717.91*input$var3*input$var11)+(-25768.83*input$var4*input$var5)+(910.75*input$var4*input$var6)+(-223267.33*input$var4*input$var8)+(-221972.72*input$var4*input$var10)+(11362.82*input$var4*input$var11)+(583.62*input$var5*input$var6)+(16204.03*input$var5*input$var8)+(11840.49*input$var5*input$var10)+(-981.70*input$var5*input$var11)+(-212.77*input$var6*input$var8)+(-570.84*input$var6*input$var10)+(-60.11*input$var6*input$var11)+(246727.00*input$var8*input$var10)+(-5110.23*input$var8*input$var11)+(-10600.74*input$var10*input$var11))/300
  # True positive ScT
  x2<-(-88677.58+(-543994.06*input$var1)+(-301203.45*input$var2)+(307294.38*input$var3)+(392302.83*input$var4)+(-8976.84*input$var5)+(-1280.14*input$var6)+(-165536.59*input$var7)+(30530.62*input$var8)+(-151444.74*input$var10)+(21023.46*input$var11)+(-108041.02*input$var13)+(-87281.56*input$var16)+(25674.20*input$var17)+(-1108.21*input$var25)+(31287.53*input$var1*input$var2)+(-41315.99*input$var1*input$var3)+(-743296.83*input$var1*input$var4)+(31842.03*input$var1*input$var5)+(355.94*input$var1*input$var6)+(772422.08*input$var1*input$var7)+(377678.37*input$var1*input$var8)+(869155.91*input$var1*input$var10)+(-38000.26*input$var1*input$var11)+(977364.48*input$var1*input$var13)+(834912.68*input$var1*input$var16)+(-43537.13*input$var1*input$var17)+(5374.52*input$var1*input$var25)+(55473.78*input$var2*input$var3)+(265454.59*input$var2*input$var4)+(-24116.86*input$var2*input$var5)+(7641.71*input$var2*input$var6)+(94142.34*input$var2*input$var7)+(-63395.84*input$var2*input$var8)+(53285.66*input$var2*input$var10)+(3734.04*input$var2*input$var11)+(96138.67*input$var2*input$var13)+(8563.88*input$var2*input$var16)+(-23683.72*input$var2*input$var17)+(63515.79*input$var2*input$var25)+(-319701.95*input$var3*input$var4)+(27761.38*input$var3*input$var5)+(-337.72*input$var3*input$var6)+(-162770.20*input$var3*input$var7)+(152721.85*input$var3*input$var8)+(339750.24*input$var3*input$var10)+(-16279.22*input$var3*input$var11)+(-263617.35*input$var3*input$var13)+(-355086.06*input$var3*input$var16)+(13009.30*input$var3*input$var17)+(-13490.32*input$var3*input$var25)+(-22111.61*input$var4*input$var5)+(390.53*input$var4*input$var6)+(-38213.48*input$var4*input$var7)+(-163758.81*input$var4*input$var8)+(-303828.46*input$var4*input$var10)+(6663.06*input$var4*input$var11)+(-38670.16*input$var4*input$var13)+(32287.30*input$var4*input$var16)+(-2982.24*input$var4*input$var17)+(21396.23*input$var4*input$var25)+(1421.46*input$var5*input$var6)+(-2955.82*input$var5*input$var7)+(14776.71*input$var5*input$var8)+(2870.90*input$var5*input$var10)+(-7055.06*input$var5*input$var11)+(-7576.74*input$var5*input$var13)+(25462.43*input$var5*input$var16)+(-3857.10*input$var5*input$var17)+(5095.05*input$var5*input$var25)+(1878.60*input$var6*input$var7)+(-752.10*input$var6*input$var8)+(-139.68*input$var6*input$var10)+(-253.72*input$var6*input$var11)+(389.25*input$var6*input$var13)+(-456.54*input$var6*input$var16)+(91.82*input$var6*input$var17)+(600.69*input$var6*input$var25)+(-59352.98*input$var7*input$var8)+(82205.91*input$var7*input$var10)+(4048.37*input$var7*input$var11)+(278417.56*input$var7*input$var13)+(215379.88*input$var7*input$var16)+(-14473.13*input$var7*input$var17)+(4385.50*input$var7*input$var25)+(152316.66*input$var8*input$var10)+(-2345.99*input$var8*input$var11)+(-86867.82*input$var8*input$var13)+(-2963.44*input$var8*input$var16)+(-4277.69*input$var8*input$var17)+(-7037.26*input$var8*input$var25)+(-9399.04*input$var10*input$var11)+(76785.30*input$var10*input$var13)+(3568.55*input$var10*input$var16)+(-2096.32*input$var10*input$var17)+(-12995.81*input$var10*input$var25)+(-6137.75*input$var11*input$var13)+(-4199.06*input$var11*input$var16)+(374.60*input$var11*input$var17)+(-4668.57*input$var11*input$var25)+(338597.98*input$var13*input$var16)+(-14987.38*input$var13*input$var17)+(-2069.81*input$var13*input$var25)+(-16978.14*input$var16*input$var17)+(19394.61*input$var16*input$var25)+(-4628.56*input$var17*input$var25))/300
  x2<- ifelse(x2<0, 0, x2)
  labs=c("EID and EPI","EID")
  x<-barplot(matrix(c(x1,x2)), ylab="Infections/100,000 births", xlab="Strategy",col=c("#75AADB","firebrick3"),border='white', main="Fig. 1: Infants identified with HIV",names.arg = c("",""),cex.names=1.2,beside=TRUE,font=2,col.axis="#75AADB",yaxt="n")
  axiscolors=c("firebrick3","#75AADB")
  Map(function(x,y,z)
    axis(1,at=x,col.axis=y,labels=z,lwd=0,font=2),
    2.5:1.5,
    axiscolors,
    labs)
  axis(1,at=1:2,labels=FALSE,lwd=0)
  axis(side=2)
  text(x,0,pos=3,col="white",font=2,cex=1.2,labels=round(c(x1,x2),digits=0))
})
output$plot11 <- renderPlot({
  #MTCT EID
  x3<-(-265456.9+(8381744.4*input$var1)+(-2819834.8*input$var2)+(740063.2*input$var3)+(788238.4*input$var4)+(-586894.3*input$var5)+(-19469.3*input$var6)+(47459.6*input$var8)+(9422.5*input$var10)+(2329.4*input$var11)+(-4221883.3*input$var1*input$var2)+(-3402586*input$var1*input$var3)+(-3430854.1*input$var1*input$var4)+(937650.8*input$var1*input$var5)+(29666.2*input$var1*input$var6)+(3327.2*input$var1*input$var8)+(-27441.2*input$var1*input$var10)+(11289.90*input$var1*input$var11)+(239165.6*input$var2*input$var3)+(412832.2*input$var2*input$var4)+(8270901.8*input$var2*input$var5)+(366210.2*input$var2*input$var6)+(-240630.7*input$var2*input$var8)+(-293880*input$var2*input$var10)+(102606*input$var2*input$var11)+(-1321143.7*input$var3*input$var4)+(-114150.6*input$var3*input$var5)+(-2755.2*input$var3*input$var6)+(-31190.3*input$var3*input$var8)+(18511.3*input$var3*input$var10)+(-5205.1*input$var3*input$var11)+(-157333.3*input$var4*input$var5)+(-4867.5*input$var4*input$var6)+(-25400.1*input$var4*input$var8)+(-273*input$var4*input$var10)+(-5225.1*input$var4*input$var11)+(101566.4*input$var5*input$var6)+(36154.8*input$var5*input$var8)+(-21748.7*input$var5*input$var10)+(-7952.1*input$var5*input$var11)+(-2876.8*input$var6*input$var8)+(283.1*input$var6*input$var10)+(-466.6*input$var6*input$var11)+(5224.80*input$var8*input$var10)+(7558.2*input$var8*input$var11)+(-3040.6*input$var10*input$var11))/300
  x3<- ifelse(x3<0, 0, x3)
  #MTCT ScT
  x4<-(-384500+(8529000*input$var1)+(-3090000*input$var2)+(726400*input$var3)+(845600*input$var4)+(-475700*input$var5)+(-16500*input$var6)+(-25870*input$var7)+(51460*input$var8)+(-10730*input$var10)+(10240*input$var11)+(79670*input$var13)+(96250*input$var16)+(1633*input$var17)+(143700*input$var25)+(-4034000*input$var1*input$var2)+(-3366000*input$var1*input$var3)+(-3467000*input$var1*input$var4)+(884500*input$var1*input$var5)+(26630*input$var1*input$var6)+(48690*input$var1*input$var7)+(-2596*input$var1*input$var8)+(-52090*input$var1*input$var10)+(11290*input$var1*input$var11)+(-115900*input$var1*input$var13)+(-104900*input$var1*input$var16)+(-22010*input$var1*input$var17)+(16740*input$var1*input$var25)+(281400*input$var2*input$var3)+(398300*input$var2*input$var4)+(8177000*input$var2*input$var5)+(360000*input$var2*input$var6)+(320400*input$var2*input$var7)+(-204200*input$var2*input$var8)+(-302000*input$var2*input$var10)+(121100*input$var2*input$var11)+(-249100*input$var2*input$var13)+(132800*input$var2*input$var16)+(66460*input$var2*input$var17)+(86770*input$var2*input$var25)+(-1309000*input$var3*input$var4)+(-95090*input$var3*input$var5)+(-1781*input$var3*input$var6)+(33940*input$var3*input$var7)+(-31420*input$var3*input$var8)+(11220*input$var3*input$var10)+(-4062*input$var3*input$var11)+(-15580*input$var3*input$var13)+(-27580*input$var3*input$var16)+(-2892*input$var3*input$var17)+(-1471*input$var3*input$var25)+(-179800*input$var4*input$var5)+(-6465*input$var4*input$var6)+(11750*input$var4*input$var7)+(-25900*input$var4*input$var8)+(-168.4*input$var4*input$var10)+(-1778*input$var4*input$var11)+(9518*input$var4*input$var13)+(-47000*input$var4*input$var16)+(-5007*input$var4*input$var17)+(-52310*input$var4*input$var25)+(98930*input$var5*input$var6)+(46270*input$var5*input$var7)+(37210*input$var5*input$var8)+(-22370*input$var5*input$var10)+(-7393*input$var5*input$var11)+(-47480*input$var5*input$var13)+(-59100*input$var5*input$var16)+(-4859*input$var5*input$var17)+(-89970*input$var5*input$var25)+(-1414*input$var6*input$var7)+(-2863*input$var6*input$var8)+(482.3*input$var6*input$var10)+(-516.8*input$var6*input$var11)+(88.92*input$var6*input$var13)+(290*input$var6*input$var16)+(236.2*input$var6*input$var17)+(-2812*input$var6*input$var25)+(9004*input$var7*input$var8)+(9605*input$var7*input$var10)+(-13760*input$var7*input$var11)+(7462*input$var7*input$var13)+(-10600*input$var7*input$var16)+(105.5*input$var7*input$var17)+(-31150*input$var7*input$var25)+(12000*input$var8*input$var10)+(6470*input$var8*input$var11)+(5934*input$var8*input$var13)+(-7137*input$var8*input$var16)+(-4770*input$var8*input$var17)+(-11610*input$var8*input$var25)+(-1857*input$var10*input$var11)+(15700*input$var10*input$var13)+(2242*input$var10*input$var16)+(4899*input$var10*input$var17)+(-2247*input$var10*input$var25)+(-5869*input$var11*input$var13)+(-7568*input$var11*input$var16)+(3765*input$var11*input$var17)+(-4540*input$var11*input$var25)+(500.2*input$var13*input$var16)+(-6558*input$var13*input$var17)+(-64110*input$var13*input$var25)+(5915*input$var16*input$var17)+(-29890*input$var16*input$var25)+(-3470*input$var17*input$var25))/300
  x4<- ifelse(x4<0, 0, x4)
  labs=c("EID and EPI","EID")
  x<-barplot(matrix(c(x3,x4)), ylab="Transmissions/100,000 births", xlab="Strategy", col=c("#75AADB","firebrick3"),border='white', main="Fig. 2: Mother-to-child transmissions",names.arg = c("",""),cex.names=1.2,beside=TRUE,font=2,col.axis="#75AADB",yaxt="n")
  axiscolors=c("firebrick3","#75AADB")
  Map(function(x,y,z)
    axis(1,at=x,col.axis=y,labels=z,lwd=0,font=2),
    2.5:1.5,
    axiscolors,
    labs)
  axis(1,at=1:2,labels=FALSE,lwd=0)
  axis(side=2)
  text(x,0,pos=3,col="white",font=2,cex=1.2,labels=round(c(x3,x4),digits=0))
})
output$plot12 <- renderPlot({
  # Alive and on ART EID
  x5<-(-67680+(1662000*input$var1)+(-247800*input$var2)+(70470*input$var3)+(367800*input$var4)+(-19180*input$var5)+(-1311*input$var6)+(-79570*input$var8)+(-75960*input$var10)+(5870*input$var11)+(-285900*input$var1*input$var2)+(-294800*input$var1*input$var3)+(-1128000*input$var1*input$var4)+(153500*input$var1*input$var5)+(1779*input$var1*input$var6)+(400800*input$var1*input$var8)+(419400*input$var1*input$var10)+(-10180*input$var1*input$var11)+(163500*input$var2*input$var3)+(65690*input$var2*input$var4)+(616500*input$var2*input$var5)+(20790*input$var2*input$var6)+(48430*input$var2*input$var8)+(20850*input$var2*input$var10)+(17090*input$var2*input$var11)+(-445700*input$var3*input$var4)+(-10680*input$var3*input$var5)+(-457.1*input$var3*input$var6)+(154400*input$var3*input$var8)+(165000*input$var3*input$var10)+(-6240*input$var3*input$var11)+(-30860*input$var4*input$var5)+(477.6*input$var4*input$var6)+(-148600*input$var4*input$var8)+(-145200*input$var4*input$var10)+(5008*input$var4*input$var11)+(6312*input$var5*input$var6)+(10910*input$var5*input$var8)+(4253*input$var5*input$var10)+(-2674*input$var5*input$var11)+(-33.47*input$var6*input$var8)+(-336.9*input$var6*input$var10)+(-91.01*input$var6*input$var11)+(158500*input$var8*input$var10)+(-3229*input$var8*input$var11)+(-6770*input$var10*input$var11))/300
  x5<- ifelse(x5<0, 0, x5)
  # Alive and on ART ScT
  x6<-(-132200+(1513000*input$var1)+(-350800*input$var2)+(366700*input$var3)+(415300*input$var4)+(-19750*input$var5)+(-1887*input$var6)+(-113400*input$var7)+(31900*input$var8)+(-95690*input$var10)+(15430*input$var11)+(-73780*input$var13)+(-70520*input$var16)+(12710*input$var17)+(1450*input$var25)+(-280200*input$var1*input$var2)+(-767900*input$var1*input$var3)+(-1242000*input$var1*input$var4)+(138200*input$var1*input$var5)+(2025*input$var1*input$var6)+(509900*input$var1*input$var7)+(223300*input$var1*input$var8)+(571600*input$var1*input$var10)+(-22570*input$var1*input$var11)+(678500*input$var1*input$var13)+(577300*input$var1*input$var16)+(-26600*input$var1*input$var17)+(15640*input$var1*input$var25)+(116200*input$var2*input$var3)+(210000*input$var2*input$var4)+(701400*input$var2*input$var5)+(25700*input$var2*input$var6)+(41740*input$var2*input$var7)+(-32510*input$var2*input$var8)+(7608*input$var2*input$var10)+(-8987*input$var2*input$var11)+(59610*input$var2*input$var13)+(72410*input$var2*input$var16)+(-15480*input$var2*input$var17)+(58610*input$var2*input$var25)+(-505600*input$var3*input$var4)+(6601*input$var3*input$var5)+(-686.8*input$var3*input$var6)+(-103900*input$var3*input$var7)+(90540*input$var3*input$var8)+(224300*input$var3*input$var10)+(-9747*input$var3*input$var11)+(-179600*input$var3*input$var13)+(-239000*input$var3*input$var16)+(5705*input$var3*input$var17)+(-13490*input$var3*input$var25)+(-30980*input$var4*input$var5)+(56.17*input$var4*input$var6)+(-27530*input$var4*input$var7)+(-107400*input$var4*input$var8)+(-203200*input$var4*input$var10)+(2039*input$var4*input$var11)+(-28620*input$var4*input$var13)+(20250*input$var4*input$var16)+(-590.3*input$var4*input$var17)+(19160*input$var4*input$var25)+(6827*input$var5*input$var6)+(-4444*input$var5*input$var7)+(9159*input$var5*input$var8)+(-399.8*input$var5*input$var10)+(-6590*input$var5*input$var11)+(-12370*input$var5*input$var13)+(21650*input$var5*input$var16)+(-2877*input$var5*input$var17)+(2801*input$var5*input$var25)+(1312*input$var6*input$var7)+(-436.4*input$var6*input$var8)+(-55.18*input$var6*input$var10)+(-213.1*input$var6*input$var11)+(267.3*input$var6*input$var13)+(-523.2*input$var6*input$var16)+(101.1*input$var6*input$var17)+(192.6*input$var6*input$var25)+(-43030*input$var7*input$var8)+(58040*input$var7*input$var10)+(2990*input$var7*input$var11)+(187600*input$var7*input$var13)+(144500*input$var7*input$var16)+(-7495*input$var7*input$var17)+(2781*input$var7*input$var25)+(92810*input$var8*input$var10)+(-999.5*input$var8*input$var11)+(-64670*input$var8*input$var13)+(1387*input$var8*input$var16)+(-1088*input$var8*input$var17)+(-6327*input$var8*input$var25)+(-6331*input$var10*input$var11)+(55020*input$var10*input$var13)+(1048*input$var10*input$var16)+(-360.8*input$var10*input$var17)+(-10390*input$var10*input$var25)+(-4488*input$var11*input$var13)+(-2530*input$var11*input$var16)+(539.6*input$var11*input$var17)+(-3756*input$var11*input$var25)+(232900*input$var13*input$var16)+(-6385*input$var13*input$var17)+(-5463*input$var13*input$var25)+(-8340*input$var16*input$var17)+(14030*input$var16*input$var25)+(-3459*input$var17*input$var25))/300
  x6<- ifelse(x6<0, 0, x6)
  labs=c("EID and EPI","EID")
  x<-barplot(matrix(c(x5,x6)), ylab="Alive and on ART/100,000 births", xlab="Strategy", col=c("#75AADB","firebrick3"),border='white', main="Fig. 3: Alive and on ART by one year",names.arg = c("",""),cex.names=1.2,beside=TRUE,font=2,col.axis="#75AADB",yaxt="n")
  axiscolors=c("firebrick3","#75AADB")
  Map(function(x,y,z)
    axis(1,at=x,col.axis=y,labels=z,lwd=0,font=2),
    2.5:1.5,
    axiscolors,
    labs)
  axis(1,at=1:2,labels=FALSE,lwd=0)
  axis(side=2)
  text(x,0,pos=3,col="white",font=2,cex=1.2,labels=round(c(x5,x6),digits=0))
})
output$plot13 <- renderPlot({
  #LmsEID
  x1<-(325.96898+(-65.64293*input$var1)+(0.85028*input$var2)+(-5.42326*input$var3)+(-4.15119*input$var4)+(2.91058*input$var5)+(0.10749*input$var6)+(-0.55402*input$var8)+(-0.36339*input$var10)+(-0.05702*input$var11)+(33.41571*input$var1*input$var2)+(24.59938*input$var1*input$var3)+(21.38804*input$var1*input$var4)+(-5.72805*input$var1*input$var5)+(-0.17202*input$var1*input$var6)+(1.99266*input$var1*input$var8)+(2.09233*input$var1*input$var10)+(-0.11179*input$var1*input$var11)+(-1.39281*input$var2*input$var3)+(-0.95314*input$var2*input$var4)+(-45.75619*input$var2*input$var5)+(-2.03017*input$var2*input$var6)+(-1.25262*input$var2*input$var8)+(0.40957*input$var2*input$var10)+(0.29101*input$var2*input$var11)+(8.47016*input$var3*input$var4)+(0.76250*input$var3*input$var5)+(0.03294*input$var3*input$var6)+(0.84607*input$var3*input$var8)+(0.76402*input$var3*input$var10)+(-0.04576*input$var3*input$var11)+(0.76045*input$var4*input$var5)+(0.02487*input$var4*input$var6)+(-0.53845*input$var4*input$var8)+(-0.70971*input$var4*input$var10)+(0.09412*input$var4*input$var11)+(-0.57044*input$var5*input$var6)+(0.13468*input$var5*input$var8)+(0.10450*input$var5*input$var10)+(0.05676*input$var5*input$var11)+(-0.00346*input$var6*input$var8)+(-0.00874*input$var6*input$var10)+(0.00164*input$var6*input$var11)+(0.78452*input$var8*input$var10)+(0.01209*input$var8*input$var11)+(-0.04867*input$var10*input$var11))/12
  x1<- ifelse(x1<0, 0, x1)
  #LmsScT
  x2<-(325.8+(-66.64*input$var1)+(1.119*input$var2)+(-4*input$var3)+(-4.04*input$var4)+(2.71*input$var5)+(0.08868*input$var6)+(-0.56870*input$var7)+(-0.10810*input$var8)+(-0.5796*input$var10)+(0.00581*input$var11)+(-0.47840*input$var13)+(-0.05943*input$var16)+(0.07171*input$var17)+(-0.22370*input$var25)+(33.93*input$var1*input$var2)+(22.41*input$var1*input$var3)+(21.21*input$var1*input$var4)+(-5.528*input$var1*input$var5)+(-0.1625*input$var1*input$var6)+(2.969*input$var1*input$var7)+(1.319*input$var1*input$var8)+(2.644*input$var1*input$var10)+(-0.2068*input$var1*input$var11)+(2.863*input$var1*input$var13)+(2.344*input$var1*input$var16)+(-0.05278*input$var1*input$var17)+(-0.4096*input$var1*input$var25)+(-1.631*input$var2*input$var3)+(-0.1795*input$var2*input$var4)+(-44.87*input$var2*input$var5)+(-1.98*input$var2*input$var6)+(1.236*input$var2*input$var7)+(-1.756*input$var2*input$var8)+(0.41140*input$var2*input$var10)+(0.2513*input$var2*input$var11)+(0.3607*input$var2*input$var13)+(-2.627*input$var2*input$var16)+(-0.2477*input$var2*input$var17)+(-0.1358*input$var2*input$var25)+(8.177*input$var3*input$var4)+(0.6897*input$var3*input$var5)+(0.02711*input$var3*input$var6)+(-0.6196*input$var3*input$var7)+(0.598*input$var3*input$var8)+(0.9834*input$var3*input$var10)+(-0.07017*input$var3*input$var11)+(-0.7655*input$var3*input$var13)+(-1.122*input$var3*input$var16)+(0.06395*input$var3*input$var17)+(0.04591*input$var3*input$var25)+(0.9303*input$var4*input$var5)+(0.03151*input$var4*input$var6)+(-0.0914*input$var4*input$var7)+(-0.3743*input$var4*input$var8)+(-0.9214*input$var4*input$var10)+(0.0905*input$var4*input$var11)+(-0.0536*input$var4*input$var13)+(0.1172*input$var4*input$var16)+(-0.03714*input$var4*input$var17)+(-0.03*input$var4*input$var25)+(-0.559*input$var5*input$var6)+(0.08266*input$var5*input$var7)+(0.1511*input$var5*input$var8)+(0.0587*input$var5*input$var10)+(0.03836*input$var5*input$var11)+(0.1127*input$var5*input$var13)+(-0.1129*input$var5*input$var16)+(0.00048*input$var5*input$var17)+(0.1121*input$var5*input$var25)+(0.00778*input$var6*input$var7)+(-0.00449*input$var6*input$var8)+(-0.00756*input$var6*input$var10)+(0.00106*input$var6*input$var11)+(0.00659*input$var6*input$var13)+(0.00449*input$var6*input$var16)+(-0.00016*input$var6*input$var17)+(0.01242*input$var6*input$var25)+(-0.1936*input$var7*input$var8)+(0.2752*input$var7*input$var10)+(-0.0318*input$var7*input$var11)+(0.8034*input$var7*input$var13)+(0.5899*input$var7*input$var16)+(-0.04943*input$var7*input$var17)+(-0.0051*input$var7*input$var25)+(0.5247*input$var8*input$var10)+(0.0247*input$var8*input$var11)+(-0.1428*input$var8*input$var13)+(-0.05491*input$var8*input$var16)+(-0.05702*input$var8*input$var17)+(0.07405*input$var8*input$var25)+(-0.05598*input$var10*input$var11)+(0.2616*input$var10*input$var13)+(0.05041*input$var10*input$var16)+(0.00479*input$var10*input$var17)+(0.1204*input$var10*input$var25)+(-0.01216*input$var11*input$var13)+(0.00154*input$var11*input$var16)+(-0.00403*input$var11*input$var17)+(-0.00442*input$var11*input$var25)+(0.8933*input$var13*input$var16)+(-0.07485*input$var13*input$var17)+(0.1575*input$var13*input$var25)+(-0.03179*input$var16*input$var17)+(0.04996*input$var16*input$var25)+(0.01685*input$var17*input$var25))/12
  x2<- ifelse(x2<0, 0, x2)
  labs=c("EID and EPI","EID")
  x<-barplot(matrix(c(x1,x2)), ylab="Life years", xlab="Strategy",col=c("#75AADB","firebrick3"),border='white', main="Life expectancy (discounted)",names.arg = c("",""),cex.names=1.2,beside=TRUE,font=2,col.axis="#75AADB",yaxt="n")
  axiscolors=c("firebrick3","#75AADB")
  Map(function(x,y,z)
    axis(1,at=x,col.axis=y,labels=z,lwd=0,font=2),
    2.5:1.5,
    axiscolors,
    labs)
  axis(1,at=1:2,labels=FALSE,lwd=0)
  axis(side=2)
  text(x,0,pos=3,col="white",font=2,cex=1.2,labels=round(c(x1,x2),digits=4))
})
output$plot14 <- renderPlot({
  #CostEID
  x3<--19.03+(637*input$var1)+(-1620*input$var2)+(255.7*input$var3)+(361.4*input$var4)+(-365.1*input$var5)+(-15.39*input$var6)+(-31.63*input$var8)+(-31.76*input$var10)+(5.6870*input$var11)+(-0.5049*input$var18)+(-0.3282*input$var20)+(0.0026*input$var21)+(-1051*input$var1*input$var2)+(-613*input$var1*input$var3)+(-812.3*input$var1*input$var4)+(227.6*input$var1*input$var5)+(8.08*input$var1*input$var6)+(90.88*input$var1*input$var8)+(85.64*input$var1*input$var10)+(-9.555*input$var1*input$var11)+(11.51*input$var1*input$var18)+(8.226*input$var1*input$var20)+(0.5837*input$var1*input$var21)+(88.91*input$var2*input$var3)+(101.9*input$var2*input$var4)+(2187*input$var2*input$var5)+(108.1*input$var2*input$var6)+(130*input$var2*input$var8)+(0.3141*input$var2*input$var10)+(1.133*input$var2*input$var11)+(8.958*input$var2*input$var18)+(4.949*input$var2*input$var20)+(0.3584*input$var2*input$var21)+(-330.1*input$var3*input$var4)+(-30.67*input$var3*input$var5)+(-1.561*input$var3*input$var6)+(32.54*input$var3*input$var8)+(33.97*input$var3*input$var10)+(-2.339*input$var3*input$var11)+(-1.041*input$var3*input$var18)+(-0.6619*input$var3*input$var20)+(-0.0642*input$var3*input$var21)+(-45.63*input$var4*input$var5)+(-0.94*input$var4*input$var6)+(-30.41*input$var4*input$var8)+(-23.24*input$var4*input$var10)+(-0.5821*input$var4*input$var11)+(-1.538*input$var4*input$var18)+(-1.13*input$var4*input$var20)+(-0.08*input$var4*input$var21)+(30.13*input$var5*input$var6)+(3.4070*input$var5*input$var8)+(-7.77*input$var5*input$var10)+(-3.75*input$var5*input$var11)+(2.1840*input$var5*input$var18)+(1.512*input$var5*input$var20)+(0.1083*input$var5*input$var21)+(0.0687*input$var6*input$var8)+(0.3533*input$var6*input$var10)+(-0.06*input$var6*input$var11)+(0.1094*input$var6*input$var18)+(0.0669*input$var6*input$var20)+(0.0051*input$var6*input$var21)+(28.89*input$var8*input$var10)+(-3.36*input$var8*input$var11)+(0.2090*input$var8*input$var18)+(0.1571*input$var8*input$var20)+(0.0012*input$var8*input$var21)+(-1.325*input$var10*input$var11)+(0.1175*input$var10*input$var18)+(0.2198*input$var10*input$var20)+(-0.0006*input$var10*input$var21)+(-0.0151*input$var11*input$var18)+(-0.0049*input$var11*input$var20)+(0.0018*input$var11*input$var21)+(0.0004*input$var18*input$var20)+(-0.0001*input$var18*input$var21)+(0.000012*input$var20*input$var21)
  x3<- ifelse(x3<0, 0, x3)
  #CostScT
  x4<--29.88+(579.4*input$var1)+(-1674*input$var2)+(331.9*input$var3)+(378.4*input$var4)+(-364*input$var5)+(-14.94*input$var6)+(-13.95*input$var7)+(-2.058*input$var8)+(-33.24*input$var10)+(6.182*input$var11)+(-21.17*input$var13)+(-57.1*input$var16)+(4.165*input$var17)+(1.046*input$var25)+(-0.9352*input$var18)+(0.6128*input$var19)+(-0.43*input$var20)+(0.01005*input$var21)+(-1037*input$var1*input$var2)+(-727.8*input$var1*input$var3)+(-845.1*input$var1*input$var4)+(203*input$var1*input$var5)+(7.504*input$var1*input$var6)+(62.44*input$var1*input$var7)+(58.31*input$var1*input$var8)+(114.1*input$var1*input$var10)+(-11.44*input$var1*input$var11)+(154.1*input$var1*input$var13)+(131.2*input$var1*input$var16)+(-10.06*input$var1*input$var17)+(26.82*input$var1*input$var25)+(12.66*input$var1*input$var18)+(-0.6394*input$var1*input$var19)+(8.881*input$var1*input$var20)+(0.5835*input$var1*input$var21)+(71.44*input$var2*input$var3)+(124.3*input$var2*input$var4)+(2195*input$var2*input$var5)+(108.9*input$var2*input$var6)+(-99.21*input$var2*input$var7)+(118*input$var2*input$var8)+(10.57*input$var2*input$var10)+(-6.466*input$var2*input$var11)+(65.95*input$var2*input$var13)+(123.7*input$var2*input$var16)+(21.75*input$var2*input$var17)+(-34.83*input$var2*input$var25)+(9.704*input$var2*input$var18)+(-0.4924*input$var2*input$var19)+(4.977*input$var2*input$var20)+(0.3472*input$var2*input$var21)+(-337.7*input$var3*input$var4)+(-20.33*input$var3*input$var5)+(-1.373*input$var3*input$var6)+(-25.79*input$var3*input$var7)+(16.44*input$var3*input$var8)+(48.76*input$var3*input$var10)+(-3.573*input$var3*input$var11)+(-41.72*input$var3*input$var13)+(-44.9*input$var3*input$var16)+(2.63*input$var3*input$var17)+(4.244*input$var3*input$var25)+(-1.353*input$var3*input$var18)+(-0.3198*input$var3*input$var19)+(-0.8434*input$var3*input$var20)+(-0.06211*input$var3*input$var21)+(-51.83*input$var4*input$var5)+(-1.475*input$var4*input$var6)+(-5.269*input$var4*input$var7)+(-23.05*input$var4*input$var8)+(-34.26*input$var4*input$var10)+(-0.4346*input$var4*input$var11)+(-3.35*input$var4*input$var13)+(7.076*input$var4*input$var16)+(-1.532*input$var4*input$var17)+(5.414*input$var4*input$var25)+(-1.643*input$var4*input$var18)+(0.06333*input$var4*input$var19)+(-1.171*input$var4*input$var20)+(-0.08339*input$var4*input$var21)+(29.78*input$var5*input$var6)+(-0.41120*input$var5*input$var7)+(4.13*input$var5*input$var8)+(-10.09*input$var5*input$var10)+(-4.651*input$var5*input$var11)+(-10.88*input$var5*input$var13)+(11.99*input$var5*input$var16)+(1.403*input$var5*input$var17)+(-8.296*input$var5*input$var25)+(2.199*input$var5*input$var18)+(0.2933*input$var5*input$var19)+(1.458*input$var5*input$var20)+(0.1091*input$var5*input$var21)+(0.06694*input$var6*input$var7)+(0.1105*input$var6*input$var8)+(0.4299*input$var6*input$var10)+(-0.05114*input$var6*input$var11)+(-0.5719*input$var6*input$var13)+(0.1509*input$var6*input$var16)+(0.07651*input$var6*input$var17)+(-0.1703*input$var6*input$var25)+(0.106*input$var6*input$var18)+(0.00488*input$var6*input$var19)+(0.06639*input$var6*input$var20)+(0.00486*input$var6*input$var21)+(-4.566*input$var7*input$var8)+(8.398*input$var7*input$var10)+(4.795*input$var7*input$var11)+(37.95*input$var7*input$var13)+(30.77*input$var7*input$var16)+(-3.951*input$var7*input$var17)+(0.09802*input$var7*input$var25)+(0.2588*input$var7*input$var18)+(0.6513*input$var7*input$var19)+(0.09499*input$var7*input$var20)+(-0.00109*input$var7*input$var21)+(15.2*input$var8*input$var10)+(-2.298*input$var8*input$var11)+(-19.12*input$var8*input$var13)+(1.216*input$var8*input$var16)+(1.84*input$var8*input$var17)+(-5.223*input$var8*input$var25)+(0.1183*input$var8*input$var18)+(-0.1951*input$var8*input$var19)+(0.1031*input$var8*input$var20)+(0.00255*input$var8*input$var21)+(-0.9935*input$var10*input$var11)+(5.032*input$var10*input$var13)+(-0.09891*input$var10*input$var16)+(0.1592*input$var10*input$var17)+(-4.319*input$var10*input$var25)+(0.20420*input$var10*input$var18)+(-0.04898*input$var10*input$var19)+(0.2718*input$var10*input$var20)+(-0.00432*input$var10*input$var21)+(-2.491*input$var11*input$var13)+(-0.6542*input$var11*input$var16)+(0.3382*input$var11*input$var17)+(0.4483*input$var11*input$var25)+(-0.02123*input$var11*input$var18)+(-0.06059*input$var11*input$var19)+(-0.01211*input$var11*input$var20)+(0.00209*input$var11*input$var21)+(54.36*input$var13*input$var16)+(-0.04295*input$var13*input$var17)+(-5.744*input$var13*input$var25)+(0.4111*input$var13*input$var18)+(-0.06323*input$var13*input$var19)+(0.1698*input$var13*input$var20)+(-0.00222*input$var13*input$var21)+(-6.228*input$var16*input$var17)+(0.5095*input$var16*input$var25)+(0.4626*input$var16*input$var18)+(-0.03676*input$var16*input$var19)+(0.3028*input$var16*input$var20)+(0.00438*input$var16*input$var21)+(-2.247*input$var17*input$var25)+(0.00192*input$var17*input$var18)+(0.03422*input$var17*input$var19)+(-0.0192*input$var17*input$var20)+(-0.0027*input$var17*input$var21)+(0.1246*input$var25*input$var18)+(0.02429*input$var25*input$var19)+(0.00157*input$var25*input$var20)+(-0.00145*input$var25*input$var21)+(-0.00037*input$var18*input$var19)+(0.00105*input$var18*input$var20)+(-0.00008*input$var18*input$var21)+(-0.00034*input$var19*input$var20)+(0.00007*input$var19*input$var21)+(-0.000002*input$var20*input$var21)
  x4<- ifelse(x4<0, 0, x4)
  labs=c("EID and EPI","EID")
  x<-barplot(matrix(c(x3,x4)), ylab="Costs in USD", xlab="Strategy",col=c("#75AADB","firebrick3"),border='white', main="Lifetime HIV-related costs (discounted)",names.arg = c("",""),cex.names=1.2,beside=TRUE,font=2,col.axis="#75AADB",yaxt="n")
  axiscolors=c("firebrick3","#75AADB")
  Map(function(x,y,z)
    axis(1,at=x,col.axis=y,labels=z,lwd=0,font=2),
    2.5:1.5,
    axiscolors,
    labs)
  axis(1,at=1:2,labels=FALSE,lwd=0)
  axis(side=2)
  text(x,0,pos=3,col="white",font=2,cex=1.2,labels=round(c(x3,x4),digits=0))
})
}
#Return a shiny app object
shinyApp(ui=ui,server=server)